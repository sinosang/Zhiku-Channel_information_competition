一、功能模块

## 1.用户模块

1. 登录
2. 注册
3. 个人信息查询
4. 个人信息修改
5. 查询浏览记录
6. 查询收藏夹
7. 查询笔记概览
8. 查询具体笔记
9. 删除浏览记录
10. 删除收藏内容
11. 删除笔记



## 2.视频管理

1. 上传视频
2. 删除视频
3. 上传视频信息
4. 获取视频关键词
5. 自动生成内容摘要
6. 编辑视频进度内容标签
7. 自动生成视频内容目录
8. 评论管理
9. 留言管理



## 3.基本使用

1. 全文搜索
2. 水平搜索
3. 个人视频标签搜索
4. 请求视频内容
5. 视频收藏（给某个位置加标签）
6. 视频笔记
7. 视频评论
8. 视频点赞
9. 视频转发
10. 聊天互动
11. 教室留言板（发送给课程上传者）



# 二、接口格式说明

## 1.接口风格

1. 统一为`json`格式
2. 每次响应结果固定有三个字段：`msg`、`code`、`data`
3. `msg`字段：非空，内含相关的描述信息（如“成功”、“登录验证失败”）
4. `code`字段：状态码，非空，具体枚举值见下方==状态码定义==（一个状态码code对应一个描述信息msg）
5. `data`字段：可空，用于封装具体的响应数据

```json
{
    "msg":"成功",
    "code":200,
    "data":{
        ...
    }   
}
```

## 2.状态码定义（更新）

1. 不管是什么请求，成功的状态码一律为`200`

2. 所有状态码的定义如下表（待工程开发会慢慢完善）：

   | 状态描述（msg）  | 状态码（code） |
   | :--------------: | :------------: |
   |       成功       |      200       |
   |     权限不足     |      300       |
   |    无访问凭证    |      301       |
   |  登录验证不通过  |      302       |
   |  没有找到该用户  |      303       |
   |   用户名已存在   |      304       |
   |   文件上传失败   |      305       |
   |  没有找到该笔记  |      306       |
   |  删除文件时出错  |      307       |
   | 无权限访问该资源 |      308       |
   |   请求格式异常   |      400       |
   |   请求方法异常   |      401       |
   |   请求路径异常   |      402       |
   |    空指针异常    |      500       |
   |   服务器无响应   |      501       |
   |    初始化失败    |      502       |
   |     未知异常     |      600       |

3. 对于所有的请求，都可能返回的状态码有：

   1. 200成功
   2. 4xx，客户端请求的错误
   3. 5xx，服务端响应的错误
   4. 600，位置异常

   由于这些状态码每个请求都可能会返回，所有在下面接口定义时就不具体给出了

4. 3xx状态对应的状态一般是针对特定请求的，在下面接口定义时会给出

## 3.URL

1. 服务器域名：`nicklorry.top`
2. 后端服务器运行的端口：`8090`
3. 下面接口定义中的路径全部为省略了域名和端口的资源地址



# 三、权限认证说明

1. 后端系统采用的是基于`jwt`的token令牌身份验证模式
2. 【登录】请求响应成功后，后端会把本次登录的token令牌放在在HTTP响应报文的响应头字段`Authorization`中
3. 除了【登录】和【注册】请求外，其他接口的调用都需要在请求头中加上`Authorization`字段，值为【登录】请求返回的token令牌
4. token令牌的过期时间设置为：40小时（方便测试）
5. 携带过期的token令牌访问和没有携带token令牌访问的结果是一样的，都是响应失败+返回状态码301



# 四、补充说明

1. 本系统中的图片上传后，会返回一个相对路径（如：`/profile/default.png`），在相对路径前面加上`nicklorry.top:8090`（ip和端口号）即可直接访问到图片资源
2. 在每个接口介绍开头的`【】`里面，除了说明了请求方式，还说明了参数的传递格式（共有三种选择，`json`，`param`（url路径参数）和`form/data`（表单））
3. 部分接口的路径有所调整
4. 分页查询的页码从1开始



# 五、用户模块

1. 下面的各项记录都对应一个接口
2. 【】内的是请求方式和请求数据格式，【】后面的是请求的资源路径
3. 数据响应格式统一为`json`（具体格式见【接口风格】）
4. 文档中解释接口参数、响应数据的表格格式：

| 参数名 | 参数含义 | 类型 | 是否非空 |
| :----: | :------: | :--: | :------: |
|        |          |      |          |
|        |          |      |          |



## 1.登录【POST/JSON】/user/login

1. 请求参数

   |  参数名  |  参数含义  |    类型    | 是否非空 |
   | :------: | :--------: | :--------: | :------: |
   | username |  用户的id  | 字符串类型 |    是    |
   | password | 用户的密码 | 字符串类型 |    是    |

2. 可能的状态码：

   1. 300： 权限不足
   2. 301 ：无访问凭证
   3. 302 ：登录验证不通过
   4. 303：没有找到该用户

3. 响应数据（`data`字段）：一个用户对象，字段信息如下：

   |     参数名      |          参数含义          |   类型    | 是否非空 |
   | :-------------: | :------------------------: | :-------: | :------: |
   |       id        |          用户的id          | 字符串型  |    是    |
   |      name       |         用户的名称         | 字符串型  |    是    |
   |   last_login    |       上一次登录时间       | Timestamp |    是    |
   | profile_picture | 用户头像地址（一个超链接） | 字符串型  |    是    |
   |      role       |       用户的角色信息       | 字符串型  |    是    |

4. ==登录成功后，响应报文的响应头的`Authorization`字段内会保存有本次登录的token令牌信息==

5. 用户角色信息暂定有如下枚举值：

   1. ADMIN（管理员）
   2. NORMAL（普通用户）
   
6. 提供的测试账户：

   1. 用户id：44738467
   2. 用户密码：123456
   3. 权限：普通用户

7. 示例：

   ```json
   //请求（json）
   {
       "username":"44738467",
       "password":"123456"
   }
   //响应（json）
   {
       "msg": "成功",
       "code": 200,
       "data": {
           "id": "44738467",
           "name": "Nick",
           "role": "普通用户",
           "last_login": "Jul 27, 2022, 8:19:15 PM",
           "profile_picture": "/profile/bc03eb3a-3f73-417b-9922-fc13f84f11d2.jpg",
           "histories_count": 10,
           "favorites_count": 10,
           "notes_count": 6
       }
   }
   ```

   

## 2.注册【POST/JSON】/user/register

1. 请求参数

   |  参数名  |  参数含义  |   类型   | 是否非空 |
   | :------: | :--------: | :------: | :------: |
   |   name   | 用户的名称 | 字符串型 |    是    |
   | password | 用户的密码 | 字符串型 |    是    |

2. 可能的状态码
   
1. 304：用户名已存在
   
3. 响应数据（`data`字段）：

   1. `data`字段封装了一个只有一个字段的对象
   2. 具体如下：

   | 参数名 | 参数含义 |   类型   | 是否非空 |
   | :----: | :------: | :------: | :------: |
   |   id   | 用户的id | 字符串型 |    是    |

5. 推荐操作：拿到了用户的id后，可以把页面跳转到登录页，并将用户的id填充上去（把用户id展示给用户，这个是用户登录的凭证）

6. 示例：

   ```json
   //请求（json）
   {
       "name":"Tom",
       "password":"123456"
   }
   
   //响应（json）
   {
       "msg": "成功",
       "code": 200,
       "data": {
           "id": "16200599"
       }
   }
   ```

   



## 3.个人信息查询 【GET/Param】/user/getInfo

1. 请求参数：无

2. 响应数据（`data`字段）：一个个人空间信息对象，字段如下：

   |     参数名      |           参数含义            |   类型    | 是否非空 |
   | :-------------: | :---------------------------: | :-------: | :------: |
   |       id        |           用户的id            | 字符串型  |    是    |
   |      name       |          用户的名称           | 字符串型  |    是    |
   |   last_login    |        上一次登录时间         | Timestamp |    是    |
   | profile_picture |  用户头像地址（一个超链接）   | 字符串型  |    是    |
   |      role       |        用户的角色信息         | 字符串型  |    是    |
   |    histories    | 浏览记录列表（返回前5条记录） |   列表    |    否    |
   |    favorites    | 收藏视频列表（返回前5条记录） |   列表    |    否    |
   |      notes      | 视频笔记列表（返回前5条记录） |   列表    |    否    |
   | histories_count |         浏览记录总数          |   整型    |    是    |
   | favorites_count |         收藏记录总数          |   整型    |    是    |
   |   notes_count   |           笔记总数            |   整型    |    是    |

3. 浏览记录对象字段介绍

   |   参数名    |    参数含义    |        类型        | 是否非空 |
   | :---------: | :------------: | :----------------: | :------: |
   |     id      | 浏览的视频的id |      字符串型      |    是    |
   |    title    |    视频标题    |      字符串型      |    是    |
   |  progress   |    观看进度    |      浮点类型      |    是    |
   |    total    |     总时长     |      浮点类型      |    是    |
   |  play_time  |    播放时间    |     Timestamp      |    是    |
   |    cover    |    视频封面    | 字符串型（超链接） |    是    |
   |  uploader   | 视频上传者名称 |      字符串型      |    是    |
   |   course    |  视频所属课程  |      字符串型      |    是    |
   |  course_id  |    课程的id    |      字符串型      |    是    |
   | uploader_id |   上传者的id   |      字符串型      |    是    |

4. 收藏夹对象字段介绍

   |    参数名    |  参数含义  |        类型        | 是否非空 |
   | :----------: | :--------: | :----------------: | :------: |
   |      id      |   视频id   |      字符串型      |    是    |
   |    title     |  视频标题  |      字符串型      |    是    |
   |    cover     |  视频封面  | 字符串型（超链接） |    是    |
   | collect_time |  收藏时间  |     timestamp      |    是    |
   |   uploader   | 上传者名称 |      字符串型      |    是    |
   |    course    |  课程名称  |      字符串型      |    是    |
   |  course_id   |  课程的id  |      字符串型      |    是    |
   | uploader_id  | 上传者的id |      字符串型      |    是    |

5. 笔记对象字段介绍

   |     参数名      |             参数含义             |          类型          | 是否非空 |
   | :-------------: | :------------------------------: | :--------------------: | :------: |
   |       id        |              笔记id              |        字符串型        |    是    |
   |      title      |             笔记标题             |        字符串型        |    是    |
   |    vedio_id     |              视频id              |        字符串型        |    是    |
   |   vedio_title   |             视频标题             |        字符串型        |    是    |
   |  note_abstract  |             内容摘要             |        文本类型        |    是    |
   |   create_time   |             创建时间             |       Timestamp        |    是    |
|    last_edit    |         上一次编辑的时间         |       Timestamp        |    是    |
   | image_bucket_id |            图片桶的id            |        字符串型        |    是    |
   |   image_urls    | 笔记中所用的图片的相对路径的集合 | 列表（泛型为字符串型） |    否    |
   
6. 示例：

   ```json
   //响应（json）
   {
       "msg": "成功",
       "code": 200,
       "data": {
           "id": "44738467",
           "name": "Nick",
           "role": "普通用户",
           "last_login": "2022-07-27T12:19:15.351+00:00",
           "profile_picture": "/profile/bc03eb3a-3f73-417b-9922-fc13f84f11d2.jpg",
           "histories_count": 10,
           "favorites_count": 10,
           "notes_count": 6,
           "histories": [
               {
                   "id": "1020",
                   "progress": 10.0,
                   "total": 100.0,
                   "play_time": "2022-07-27T14:16:09.368+00:00",
                   "uploader_id": "16200599",
                   "course_id": "1020",
                   "title": "测试视频10",
                   "cover": "/cover/course/default.png",
                   "uploader": "Tom",
                   "course": "测试课程10"
               },
               {
                   "id": "1019",
                   "progress": 9.0,
                   "total": 90.0,
                   "play_time": "2022-07-27T14:16:08.331+00:00",
                   "uploader_id": "16200599",
                   "course_id": "1019",
                   "title": "测试视频9",
                   "cover": "/cover/course/default.png",
                   "uploader": "Tom",
                   "course": "测试课程9"
               },
               {
                   "id": "1018",
                   "progress": 8.0,
                   "total": 80.0,
                   "play_time": "2022-07-27T14:16:07.293+00:00",
                   "uploader_id": "16200599",
                   "course_id": "1018",
                   "title": "测试视频8",
                   "cover": "/cover/course/default.png",
                   "uploader": "Tom",
                   "course": "测试课程8"
               },
               {
                   "id": "1017",
                   "progress": 7.0,
                   "total": 70.0,
                   "play_time": "2022-07-27T14:16:06.257+00:00",
                   "uploader_id": "16200599",
                   "course_id": "1017",
                   "title": "测试视频7",
                   "cover": "/cover/course/default.png",
                   "uploader": "Tom",
                   "course": "测试课程7"
               },
               {
                   "id": "1016",
                   "progress": 6.0,
                   "total": 60.0,
                   "play_time": "2022-07-27T14:16:05.222+00:00",
                   "uploader_id": "16200599",
                   "course_id": "1016",
                   "title": "测试视频6",
                   "cover": "/cover/course/default.png",
                   "uploader": "Tom",
                   "course": "测试课程6"
               }
           ],
           "favorites": [
               {
                   "id": "1019",
                   "collect_time": "2022-07-27T15:13:19.673+00:00",
                   "uploader_id": "16200599",
                   "course_id": "1019",
                   "title": "测试视频9",
                   "cover": "/cover/course/default.png",
                   "uploader": "Tom",
                   "course": "测试课程9"
               },
               {
                   "id": "1018",
                   "collect_time": "2022-07-27T15:13:18.635+00:00",
                   "uploader_id": "16200599",
                   "course_id": "1018",
                   "title": "测试视频8",
                   "cover": "/cover/course/default.png",
                   "uploader": "Tom",
                   "course": "测试课程8"
               },
               {
                   "id": "1017",
                   "collect_time": "2022-07-27T15:13:17.608+00:00",
                   "uploader_id": "16200599",
                   "course_id": "1017",
                   "title": "测试视频7",
                   "cover": "/cover/course/default.png",
                   "uploader": "Tom",
                   "course": "测试课程7"
               },
               {
                   "id": "1016",
                   "collect_time": "2022-07-27T15:13:16.575+00:00",
                   "uploader_id": "16200599",
                   "course_id": "1016",
                   "title": "测试视频6",
                   "cover": "/cover/course/default.png",
                   "uploader": "Tom",
                   "course": "测试课程6"
               }
           ],
           "notes": [
               {
                   "id": "50238964",
                   "title": "Nick上传的第六篇笔记",
                   "video_id": "1016",
                   "note_abstract": "Nick上传的第六篇笔记的摘要",
                   "create_time": "2022-07-27T13:50:26.623+00:00",
                   "last_edit": "2022-07-27T13:50:26.623+00:00",
                   "image_bucket_id": "50239037",
                   "content": null,
                   "video_title": "测试视频6",
                   "image_urls": [
                       "/note/cc6f44b1-60a2-46b6-a05d-c8fdda137aab.jpg",
                       "/note/693e6ae5-2854-488d-91dc-a7509e1b2ee7.png"
                   ]
               },
               {
                   "id": "50622473",
                   "title": "Nick上传的第五篇笔记",
                   "video_id": "1015",
                   "note_abstract": "Nick上传的第五篇笔记的摘要",
                   "create_time": "2022-07-27T13:50:14.562+00:00",
                   "last_edit": "2022-07-27T13:50:14.562+00:00",
                   "image_bucket_id": "50620324",
                   "content": null,
                   "video_title": "测试视频5",
                   "image_urls": []
               },
               {
                   "id": "50973394",
                   "title": "Nick上传的第四篇笔记",
                   "video_id": "1014",
                   "note_abstract": "Nick上传的第四篇笔记的摘要",
                   "create_time": "2022-07-27T13:50:03.697+00:00",
                   "last_edit": "2022-07-27T13:50:03.697+00:00",
                   "image_bucket_id": "50976604",
                   "content": null,
                   "video_title": "测试视频4",
                   "image_urls": []
               },
               {
                   "id": "49170287",
                   "title": "Nick上传的第三篇笔记",
                   "video_id": "1013",
                   "note_abstract": "Nick上传的第三篇笔记的摘要",
                   "create_time": "2022-07-27T13:49:53.117+00:00",
                   "last_edit": "2022-07-27T13:49:53.117+00:00",
                   "image_bucket_id": "49176717",
                   "content": null,
                   "video_title": "测试视频3",
                   "image_urls": []
               },
               {
                   "id": "47469119",
                   "title": "Nick上传的第二篇笔记",
                   "video_id": "1012",
                   "note_abstract": "Nick上传的第二篇笔记的摘要",
                   "create_time": "2022-07-27T13:47:14.946+00:00",
                   "last_edit": "2022-07-27T13:53:20.158+00:00",
                   "image_bucket_id": "20008756",
                   "content": null,
                   "video_title": "测试视频2",
                   "image_urls": [
                       "/note/de50f2b9-8c7b-423d-92fb-ae361421aa5e.jpg",
                       "/note/a32b97ee-3062-4120-99c5-03743913b4a7.png"
                   ]
               }
           ]
       }
   }
   ```

7. 在【个人信息查询】接口，会响应出用户的浏览记录、收藏记录和所做的笔记列表，但最多只响应最近的5条数据

## 4.个人信息修改 【PUT/Form-data】/user/updateInfo

1. 请求参数

   |     参数名      | 参数含义 |   类型   | 是否非空 |
   | :-------------: | :------: | :------: | :------: |
   |      name       | 用户名称 | 字符串型 |    否    |
   | profile_picture | 用户头像 | 文件类型 |    否    |
|    password     | 用户密码 | 字符串型 |    否    |
   
2. 请求参数说明：

   1. 哪项参数不为空，就进行哪项修改
   2. 当某项参数为空时，不对该参数进行修改

3. 可能的状态码：

   1. 304：用户名已存在
   2. 305：文件上传失败
   3. 307：删除文件时出错

4. 响应数据：一个用户对象，字段信息如下：

   |     参数名      |          参数含义          |   类型   | 是否非空 |
   | :-------------: | :------------------------: | :------: | :------: |
   |       id        |          用户的id          | 字符串型 |    是    |
   |      name       |         用户的名称         | 字符串型 |    是    |
   | profile_picture | 用户头像地址（一个超链接） | 字符串型 |    是    |

5. 示例：
   ![image-20220727232709523](接口文档v4.assets/个人信息修改请求测试.png)

   ```json
   {
       "msg": "成功",
       "code": 200,
       "data": {
           "id": "44738467",
           "name": "Jerry",
           "profile_picture": "/profile/bc03eb3a-3f73-417b-9922-fc13f84f11d2.jpg",
       }
   }
   ```

   

# 六、笔记模块

## 1.查询笔记概览【GET/Param】/note/getNotes

1. 请求参数：

   | 参数名 |    参数含义    | 类型 | 是否非空 |
   | :----: | :------------: | :--: | :------: |
   |  page  | 页码，从1开始  | 整型 |    是    |
   |  size  | 每页的请求数量 | 整型 |    是    |

1. 响应数据：一个列表，列表的元素对象字段信息如下：

   |     参数名      |             参数含义             |          类型          | 是否非空 |
   | :-------------: | :------------------------------: | :--------------------: | :------: |
   |       id        |              笔记id              |        字符串型        |    是    |
   |      title      |             笔记标题             |        字符串型        |    是    |
   |    vedio_id     |              视频id              |        字符串型        |    是    |
   |   vedio_title   |             视频标题             |        字符串型        |    是    |
   |  note_abstract  |             内容摘要             |        文本类型        |    是    |
   |   create_time   |             创建时间             |       timestamp        |    是    |
   | image_bucket_id |            图片桶的id            |        字符串型        |    是    |
   |   image_urls    | 笔记中所用的图片的相对路径的集合 | 列表（泛型为字符串型） |    否    |

1. 示例：

   ```json
   //请求（param）
   
   http://nicklorry.top:8090/note/getNotes?page=1&size=10
   
   //响应（json）
   {
       "msg": "成功",
       "code": 200,
       "data": [
           {
               "id": "50238964",
               "title": "Nick上传的第六篇笔记",
               "video_id": "1016",
               "note_abstract": "Nick上传的第六篇笔记的摘要",
               "create_time": "2022-07-27T13:50:26.623+00:00",
               "last_edit": "2022-07-27T13:50:26.623+00:00",
               "image_bucket_id": "50239037",
               "content": null,
               "video_title": "测试视频6",
               "image_urls": [
                   "/note/cc6f44b1-60a2-46b6-a05d-c8fdda137aab.jpg",
                   "/note/693e6ae5-2854-488d-91dc-a7509e1b2ee7.png"
               ]
           },
           {
               "id": "50622473",
               "title": "Nick上传的第五篇笔记",
               "video_id": "1015",
               "note_abstract": "Nick上传的第五篇笔记的摘要",
               "create_time": "2022-07-27T13:50:14.562+00:00",
               "last_edit": "2022-07-27T13:50:14.562+00:00",
               "image_bucket_id": "50620324",
               "content": null,
               "video_title": "测试视频5",
               "image_urls": []
           },
           {
               "id": "50973394",
               "title": "Nick上传的第四篇笔记",
               "video_id": "1014",
               "note_abstract": "Nick上传的第四篇笔记的摘要",
               "create_time": "2022-07-27T13:50:03.697+00:00",
               "last_edit": "2022-07-27T13:50:03.697+00:00",
               "image_bucket_id": "50976604",
               "content": null,
               "video_title": "测试视频4",
               "image_urls": []
           },
           {
               "id": "49170287",
               "title": "Nick上传的第三篇笔记",
               "video_id": "1013",
               "note_abstract": "Nick上传的第三篇笔记的摘要",
               "create_time": "2022-07-27T13:49:53.117+00:00",
               "last_edit": "2022-07-27T13:49:53.117+00:00",
               "image_bucket_id": "49176717",
               "content": null,
               "video_title": "测试视频3",
               "image_urls": []
           },
           {
               "id": "47469119",
               "title": "Nick上传的第二篇笔记",
               "video_id": "1012",
               "note_abstract": "Nick上传的第二篇笔记的摘要",
               "create_time": "2022-07-27T13:47:14.946+00:00",
               "last_edit": "2022-07-27T13:53:20.158+00:00",
               "image_bucket_id": "20008756",
               "content": null,
               "video_title": "测试视频2",
               "image_urls": [
                   "/note/de50f2b9-8c7b-423d-92fb-ae361421aa5e.jpg",
                   "/note/a32b97ee-3062-4120-99c5-03743913b4a7.png"
               ]
           },
           {
               "id": "41215527",
               "title": "Nick上传的第一篇笔记",
               "video_id": "1011",
               "note_abstract": "Nick上传的第一篇笔记的摘要",
               "create_time": "2022-07-27T13:41:01.922+00:00",
               "last_edit": "2022-07-27T13:45:54.134+00:00",
               "image_bucket_id": "59794743",
               "content": null,
               "video_title": "测试视频1",
               "image_urls": [
                   "/note/72710740-af5f-4985-acad-2898ff2b1664.jpg",
                   "/note/9dc787a8-d0fe-4404-bc81-7e2a39c319bb.png"
               ]
           }
       ]
   }
   ```

   

## 2.查看具体的笔记【GET/Param】/note/getNote

1. 请求参数：

   | 参数名 | 参数含义 |   类型   | 是否非空 |
   | :----: | :------: | :------: | :------: |
   |   id   | 笔记的id | 字符串型 |    是    |

2. 响应数据：

   |     参数名      |             参数含义             |          类型          | 是否非空 |
   | :-------------: | :------------------------------: | :--------------------: | :------: |
   |       id        |             笔记的id             |        字符串型        |    是    |
   |      title      |            笔记的标题            |        字符串型        |    是    |
   |    video_id     |           对应视频的id           |        字符串型        |    是    |
   |   video_title   |          对应视频的标题          |        字符串型        |    是    |
   |  note_abstract  |            笔记的摘要            |        字符串型        |    是    |
   |     content     |          笔记的正文内容          |        字符串型        |    是    |
   |   create_time   |          笔记的创建时间          |       timestamp        |    是    |
   |    last_edit    |         上一次编辑的时间         |       timestamp        |    是    |
   | image_bucket_id |            图片桶的id            |        字符串型        |    是    |
   |   image_urls    | 笔记中所用的图片的相对路径的集合 | 列表（泛型为字符串型） |    否    |

3. 示例：

   ```json
   //请求（param）
   
   nicklorry.top:8090/note/getNote?id=41215527
   
   //响应（json）
   {
       "msg": "成功",
       "code": 200,
       "data": {
           "id": "41215527",
           "title": "Nick上传的第一篇笔记",
           "video_id": "1011",
           "note_abstract": "Nick上传的第一篇笔记的摘要",
           "create_time": "2022-07-27T13:41:01.922+00:00",
           "last_edit": "2022-07-27T13:45:54.134+00:00",
           "image_bucket_id": "59794743",
           "content": "Nick上传的第一篇笔记的内容：阿尼亚：http://nicklorry.top:8090/note/9dc787a8-d0fe-4404-bc81-7e2a39c319bb.png\n 特莉休：http://nicklorry.top:8090/note/72710740-af5f-4985-acad-2898ff2b1664.jpg",
           "video_title": "测试视频1",
           "image_urls": [
               "/note/72710740-af5f-4985-acad-2898ff2b1664.jpg",
               "/note/9dc787a8-d0fe-4404-bc81-7e2a39c319bb.png"
           ]
       }
   }
   ```

4. 可能的状态码：
   1. 306：没有找到该笔记
   2. 308：无权限访问该资源
5. ==对图片桶的解释==：每篇笔记除了有一个专属的`id`外，还对应了一个专属的图片桶（image bucket）的id（图片桶内部存放了某篇笔记中所用到的图片的相对路径）。当我们需要在笔记中插入图片的时候，应该调用下面的【上传图片】接口，传入图片桶id和图片文件，将图片上传到对应的图片桶中

## 3.上传笔记【POST/JSON】/note/postNote

1. 请求参数

   |     参数名      |    参数含义    |   类型   | 是否非空 |
   | :-------------: | :------------: | :------: | :------: |
   |      title      |   笔记的标题   | 字符串型 |    是    |
   |    video_id     |  对应视频的id  | 字符串型 |    是    |
   |  note_abstract  |   笔记的摘要   | 字符串型 |    是    |
   |     content     | 笔记的正文内容 | 字符串型 |    是    |
   | image_bucket_id |   图片桶的id   | 字符串型 |    否    |

2. 响应数据

   |     参数名      |             参数含义             |          类型          | 是否非空 |
   | :-------------: | :------------------------------: | :--------------------: | :------: |
   |       id        |             笔记的id             |        字符串型        |    是    |
   |      title      |            笔记的标题            |        字符串型        |    是    |
   |    video_id     |           对应视频的id           |        字符串型        |    是    |
   |   video_title   |          对应视频的标题          |        字符串型        |    是    |
   |  note_abstract  |            笔记的摘要            |        字符串型        |    是    |
   |     content     |          笔记的正文内容          |        字符串型        |    是    |
   |   create_time   |          笔记的创建时间          |       Timestamp        |    是    |
   |    last_edit    |         上一次编辑的时间         |       Timestamp        |    是    |
   | image_bucket_id |            图片桶的id            |        字符串型        |    是    |
   |   image_urls    | 笔记中所用的图片的相对路径的集合 | 列表（泛型为字符串型） |    否    |

3. 示例：

   ```json
   //请求（json）
   {
       "title":"Nick上传的第六篇笔记",
       "video_id":"1016",
       "note_abstract":"Nick上传的第六篇笔记的摘要",
       "content":"Nick上传的第六篇的内容"
   }
   //响应（json）
   {
       "msg": "成功",
       "code": 200,
       "data": {
           "id": "50238964",
           "title": "Nick上传的第六篇笔记",
           "video_id": "1016",
           "note_abstract": "Nick上传的第六篇笔记的摘要",
           "create_time": "2022-07-27T13:50:26.623+00:00",
           "last_edit": "2022-07-27T13:50:26.623+00:00",
           "image_bucket_id": "50239037",
           "content": "Nick上传的第六篇的内容",
           "video_title": "测试视频6",
           "image_urls": []
       }
   }
   ```

4. ==关于图片桶id（image_bucket_id）的说明：==

   1. 在上传笔记时，如果笔记中没有插入图片（即暂时不需要用到图片桶），`iamge_bucket_id`可以为空，此时响应的结果中，会分配一个唯一的`image_bucket_id`，前端可以对该`image_bucket_id`进行缓存，以便之后插入图片时可以调用【上传图片】接口上传图片到该笔记的图片桶中；
   2. 在上传笔记时，如果笔记中有插入图片（此时在调用【上传笔记】接口之前，就已经调用过【上传图片】接口了，【上传图片】接口会分配一个`image_bucket_id`并返回），这时需要把图片所上传到的图片桶的id作为`image_bucket_id`参数传入



## 4.上传图片【POST/Form-data】/note/uploadImage

1. 请求参数

   |     参数名      |                           参数含义                           |   类型   | 是否非空 |
   | :-------------: | :----------------------------------------------------------: | :------: | :------: |
   |      image      |                      所要上传的图片文件                      |   file   |    是    |
   | image_bucket_id | 图片桶的id（图片桶即存放图片相对路径的集合，唯一对应一篇笔记） | 字符串型 |    否    |

2. 响应数据

   |     参数名      |                           参数含义                           |   类型   | 是否非空 |
   | :-------------: | :----------------------------------------------------------: | :------: | :------: |
   | image_bucket_id | 图片桶的id（图片桶即存放图片相对路径的集合，唯一对应一篇笔记） | 字符串型 |    是    |
   |    image_url    |   所上传的图片的相对路径（加上ip和端口号后就可以直接访问）   | 字符串型 |    是    |

3. 示例：
   ![image-20220728001450646](接口文档v4.assets/上传图片请求测试.png)

   ```json
   //响应结果（json）
   {
       "msg": "成功",
       "code": 200,
       "data": {
           "image_bucket_id": "50239037",
           "image_url": "/note/693e6ae5-2854-488d-91dc-a7509e1b2ee7.png"
       }
   }
   ```

   4. 可能的状态码：
      1. 305：文件上传失败
   5. ==接口使用说明：==
      1. 当我们在编辑一篇新的笔记时（此时还没调用【上传笔记】接口，故还没有得到相应的笔记的id），在编辑过程中可能需要插入图片，在第一次插入图片时可以不带`image_bucket_id`调用该接口，服务器会分配并返回一个新的`image_bucket_id`给当前这篇未上传的笔记使用，之后插入的图片在调用该接口上传时都需要带上该`image_bucket_id`。当完成编辑后，需要把编辑时所用的`image_bucket_id`作为参数传入【上传笔记】接口中
      2. 当我们要对一篇笔记进行修改时（该笔记已经调用过【上传笔记】接口了，有一个分配好的`image_bucket_id`）。此时若需要插入新的图片，则应该使用该笔记所对应的`image_bucket_id`作为参数调用该接口
      3. 总而言之，如果当前笔记没有分配`image_bucket_id`，可直接调用该接口以分配得到一个`image_bucket_id`（之后需要作为【上传笔记】接口的参数）；如果当前笔记已经有分配好的`image_bucket_id`，则直接使用笔记对应的`image_bucket_id`来调用该接口



## 5.更新笔记【PUT/Json】/note/updateNote

1. 请求参数

   |    参数名     |    参数含义    |   类型   | 是否非空 |
   | :-----------: | :------------: | :------: | :------: |
   |      id       |    笔记的id    | 字符串型 |    是    |
   |     title     |   笔记的标题   | 字符串型 |    否    |
   | note_abstract |   笔记的摘要   | 字符串型 |    否    |
   |    content    | 笔记的正文内容 | 字符串型 |    否    |

2. 响应数据

   |     参数名      |             参数含义             |          类型          | 是否非空 |
   | :-------------: | :------------------------------: | :--------------------: | :------: |
   |       id        |             笔记的id             |        字符串型        |    是    |
   |      title      |            笔记的标题            |        字符串型        |    是    |
   |    video_id     |           对应视频的id           |        字符串型        |    是    |
   |   video_title   |          对应视频的标题          |        字符串型        |    是    |
   |  note_abstract  |            笔记的摘要            |        字符串型        |    是    |
   |     content     |          笔记的正文内容          |        字符串型        |    是    |
   |   create_time   |          笔记的创建时间          |       Timestamp        |    是    |
   |    last_edit    |         上一次编辑的时间         |       Timestamp        |    是    |
   | image_bucket_id |            图片桶的id            |        字符串型        |    是    |
   |   image_urls    | 笔记中所用的图片的相对路径的集合 | 列表（泛型为字符串型） |    否    |

3. 示例：

   ```json
   //请求（json）
   {
       "id":"47469119",
       "image_bucket_id":"50239037",
       "content":"Nick上传的第二篇笔记的内容：吉良吉影：http://nicklorry.top:8090/note/cc6f44b1-60a2-46b6-a05d-c8fdda137aab.jpg\n 岸边露伴：http://nicklorry.top:8090/note/693e6ae5-2854-488d-91dc-a7509e1b2ee7.png"
   }
   //响应（json）
   {
       "msg": "成功",
       "code": 200,
       "data": {
           "id": "47469119",
           "title": "Nick上传的第二篇笔记",
           "video_id": "1012",
           "note_abstract": "Nick上传的第二篇笔记的摘要",
           "create_time": "2022-07-27T13:47:14.946+00:00",
           "last_edit": "2022-07-27T13:53:20.158+00:00",
           "image_bucket_id": "20008756",
           "content": "Nick上传的第二篇笔记的内容：吉良吉影：http://nicklorry.top:8090/note/cc6f44b1-60a2-46b6-a05d-c8fdda137aab.jpg\n 岸边露伴：http://nicklorry.top:8090/note/693e6ae5-2854-488d-91dc-a7509e1b2ee7.png",
           "video_title": "测试视频2",
           "image_urls": [
               "/note/de50f2b9-8c7b-423d-92fb-ae361421aa5e.jpg",
               "/note/a32b97ee-3062-4120-99c5-03743913b4a7.png"
           ]
       }
   }
   ```

4. ==接口使用说明==：

   1. 要修改那一个字段，就传入对应字段的值
   2. 其他字段在不需要修改时，值为null即可

## 6.删除笔记【DELETE/Param】/note/deleteNotes

1. 请求参数：

   | 参数名 |   参数含义   |   类型   | 是否非空 |
   | :----: | :----------: | :------: | :------: |
   |   id   |   笔记的id   | 字符串型 |    否    |
   |  ids   | 笔记的id集合 |   列表   |    否    |

2. 响应参数：无

3. 可能的状态码：

   1. 307：删除文件时出错
   2. 308：无权限访问该资源





# 七、视频模块

## 1.请求视频流【GET/Param】/oss/getVideo

1. 请求参数：

   | 参数名 | 参数含义 |   类型   | 是否非空 |
   | :----: | :------: | :------: | :------: |
   |   id   | 视频的id | 字符串型 |    是    |

2. 响应数据：
   视频流，可以用`<video>`标签进行接收并渲染



## 2.查询视频的完整信息【GET/Param】/video/getInfo

1. 请求参数：

   |     参数名     |                           参数含义                           |   类型   | 是否非空 |
   | :------------: | :----------------------------------------------------------: | :------: | :------: |
   |       id       |                           视频的id                           | 字符串型 |    是    |
   |     course     |    是否查询course字段，是为true，否为false（默认为false）    |  布尔型  |    是    |
   |     remark     |    是否查询remark字段，是为true，否为false（默认为false）    |  布尔型  |    是    |
   | video_abstract | 是否查询video_abstract字段，是为true，否为false（默认为false） |  布尔型  |    是    |
   |    content     |   是否查询content字段，是为true，否为false（默认为false）    |  布尔型  |    是    |
   |      tags      |     是否查询tags字段，是为true，否为false（默认为false）     |  布尔型  |    是    |
   |     labels     |    是否查询labels字段，是为true，否为false（默认为false）    |  布尔型  |    是    |
   |    comments    |   是否查询comments字段，是为true，否为false（默认为false）   |  布尔型  |    是    |
   
2. 响应数据：

   |     参数名     |       参数含义       |       类型       | 是否非空 |
   | :------------: | :------------------: | :--------------: | :------: |
   |       id       |       视频的id       |     字符串型     |    是    |
   |    uploader    |      上传者名称      |     字符串型     |    是    |
   |  uploader_id   |       上传者id       |     字符串型     |    是    |
   |     video      |    视频的请求地址    |     字符串型     |    是    |
   |     cover      | 视频的封面的请求地址 |     字符串型     |    是    |
   |  upload_time   |       上传时间       |    Timestamp     |    是    |
   |     title      |      视频的标题      |     字符串型     |    是    |
   |     remark     |      视频的备注      |     字符串型     |    否    |
   | video_abstract |      视频的摘要      |     字符串型     |    否    |
   |    content     |    视频的内容全文    |     字符串型     |    否    |
   |      tags      |      视频的标签      |   字符串型数组   |    否    |
   |     labels     |    视频的进度标签    | 进度标签类型数组 |    否    |
   |     course     |  视频所属的课程对象  |     课程类型     |    否    |
   |    comments    |      视频的评论      |   评论类型数组   |    否    |
   |    is_exist    |  视频是否存在的标识  |     布尔类型     |    是    |
   
3. 进度标签类型的字段介绍：

   | 参数名 |      参数含义      |   类型   | 是否非空 |
   | :----: | :----------------: | :------: | :------: |
   |   id   |      标签的id      | 字符串型 |    是    |
   | start  | 对应进度的起始位置 |  浮点型  |    是    |
   |  end   | 对应进度的结束位置 |  浮点型  |    是    |
   |  body  |      标签内容      | 字符串型 |    是    |
   
4. 课程类型的字段介绍：

   |   参数名    |         参数含义         |   类型    | 是否非空 |
   | :---------: | :----------------------: | :-------: | :------: |
   |     id      |        所属课程id        | 字符串型  |    是    |
   |    title    |       所属课程名称       | 字符串型  |    是    |
   |    cover    |    课程封面的请求地址    | 字符串型  |    是    |
   | create_time |      课程的创建时间      | Timestamp |    是    |
   |   author    |        课程的作者        | 字符串型  |    是    |
   |  author_id  |      课程的作者的id      | 字符串型  |    是    |
   |   chapter   | 视频在该课程中所处的章节 | 章节类型  |    是    |
   |  is_exist   |    课程是否存在的标识    | 布尔类型  |    是    |

5. 章节类型的字段介绍：

   |  参数名  |    参数含义    |                    类型                    | 是否非空 |
   | :------: | :------------: | :----------------------------------------: | :------: |
   |    id    |    章节的id    |                  字符串型                  |    是    |
   |   body   | 章节标签的内容 |                  字符串型                  |    是    |
   | level_id | 所属章节的层级 | 字符串型（形式如：`1`、``1.1`、`2.1.2`等） |    是    |
   |   body   | 所属章节的标题 |                  字符串型                  |    是    |

6. 评论类型的字段介绍：
   
|     参数名      |    参数含义    |   类型    | 是否非空 |
| :-------------: | :------------: | :-------: | :------: |
|       id        |    评论的id    | 字符串型  |    是    |
|      body       |   评论的内容   | 字符串型  |    是    |
| profile_picture | 用户的头像地址 | 字符串型  |    是    |
|    reviewer     |  评论的用户名  | 字符串型  |    是    |
|     comment     |   评论的时间   | Timestamp |    是    |

7. 请求示例：
   ![image-20220813204400568](接口文档v4.assets/查询视频完整信息请求测试.png)

   ```json
   {
       "msg": "成功",
       "code": 200,
       "data": {
           "id": "16565363",
           "uploader": "Nick",
           "uploader_id": "44738467",
           "video": "video/16603785781251723891.mp4",
           "cover": "video_cover/16603785789451275035.png",
           "upload_time": "2022-08-13T08:16:19.056+00:00",
           "title": "生草化学",
           "course": {
               "id": "22593815",
               "title": "科学课",
               "cover": "course_cover/16603753619681417958.png",
               "create_time": "2022-08-13T07:22:42.160+00:00",
               "author": "Nick",
               "author_id": "44738467",
               "chapter": {
                   "id": "31055673",
                   "body": "生草化学",
                   "level_id": "1.1",
                   "video_id": "16565363",
               },
               "is_exist": true
           },
           "remark": "这个是关于关于化学的课程",
           "video_abstract": "这个是生草啊啊啊啊啊啊啊",
           "content": "生草化学不生草",
           "tags": [
               "化学",
               "有机物",
               "科学课"
           ],
           "labels": [
               {
                   "id": "57066465",
                   "video_id": "16565363",
                   "start": 1.0,
                   "end": 2.0,
                   "body": "笨"
               },
               {
                   "id": "57060119",
                   "video_id": "16565363",
                   "start": 2.0,
                   "end": 3.0,
                   "body": "茚"
               },
               {
                   "id": "57062354",
                   "video_id": "16565363",
                   "start": 3.0,
                   "end": 4.0,
                   "body": "薁"
               },
               {
                   "id": "57068395",
                   "video_id": "16565363",
                   "start": 4.0,
                   "end": 5.0,
                   "body": "萘"
               },
               {
                   "id": "57063428",
                   "video_id": "16565363",
                   "start": 5.0,
                   "end": 6.0,
                   "body": "苊"
               },
               {
                   "id": "57060694",
                   "video_id": "16565363",
                   "start": 6.0,
                   "end": 7.0,
                   "body": "莒"
               }
           ],
           "is_exist": true,
           "comments": [
               {
                   "id": "27766577",
                   "body": "评论测试7",
                   "reviewer": "Nick",
                   "profile_picture": "profile_picture/default.png",
                   "comment_time": "2022-08-29T11:27:51.000+00:00"
               },
               {
                   "id": "27989765",
                   "body": "评论测试6",
                   "reviewer": "Nick",
                   "profile_picture": "profile_picture/default.png",
                   "comment_time": "2022-08-29T11:27:49.000+00:00"
               },
               {
                   "id": "27001326",
                   "body": "评论测试5",
                   "reviewer": "Nick",
                   "profile_picture": "profile_picture/default.png",
                   "comment_time": "2022-08-29T11:27:47.000+00:00"
               },
               {
                   "id": "27767936",
                   "body": "评论测试4",
                   "reviewer": "Nick",
                   "profile_picture": "profile_picture/default.png",
                   "comment_time": "2022-08-29T11:27:45.000+00:00"
               },
               {
                   "id": "27507193",
                   "body": "评论测试3",
                   "reviewer": "Nick",
                   "profile_picture": "profile_picture/default.png",
                   "comment_time": "2022-08-29T11:27:42.000+00:00"
               }
           ]
       }
   }
   ```

   





## 3.查询视频的部分信息【GET/Param】/video/getInfoField

1. 请求参数：

   |     参数名     |                           参数含义                           |   类型   | 是否非空 |
   | :------------: | :----------------------------------------------------------: | :------: | :------: |
   |       id       |                           视频的id                           | 字符串型 |    是    |
   |     course     |    是否查询course字段，是为true，否为false（默认为false）    |  布尔型  |    是    |
   |     remark     |    是否查询remark字段，是为true，否为false（默认为false）    |  布尔型  |    是    |
   | video_abstract | 是否查询video_abstract字段，是为true，否为false（默认为false） |  布尔型  |    是    |
   |    content     |   是否查询content字段，是为true，否为false（默认为false）    |  布尔型  |    是    |
   |      tags      |     是否查询tags字段，是为true，否为false（默认为false）     |  布尔型  |    是    |
   |     labels     |    是否查询labels字段，是为true，否为false（默认为false）    |  布尔型  |    是    |
   |    comments    |   是否查询comments字段，是为true，否为false（默认为false）   |  布尔型  |    是    |
   
2. 响应数据：

   |     参数名     |      参数含义      |       类型       | 是否非空 |
   | :------------: | :----------------: | :--------------: | :------: |
   |     course     |     所属的课程     |     课程类型     |    否    |
   |     remark     |     视频的备注     |     字符串型     |    否    |
   | video_abstract |     视频的摘要     |     字符串型     |    否    |
   |    content     |   视频的内容全文   |     字符串型     |    否    |
   |      tags      |     视频的标签     |   字符串型数组   |    否    |
   |     labels     |   视频的进度标签   | 进度标签类型数组 |    否    |
   |    comments    |     视频的评论     |   评论类型数组   |    否    |
   |    is_exist    | 视频是否存在的标识 |     布尔类型     |    是    |

3. 请求示例：
   ![image-20220813211421425](接口文档v4.assets/查询视频部分信息请求测试.png)

   ```json
   {
       "msg": "成功",
       "code": 200,
       "data": {
           "id": "16565363",
           "course": {
               "id": "22593815",
               "title": "科学课",
               "cover": "course_cover/16603753619681417958.png",
               "create_time": "2022-08-13T07:22:42.160+00:00",
               "author": "Nick",
               "author_id": "44738467",
               "chapter": {
                   "id": "31055673",
                   "body": "生草化学",
                   "level_id": "1.1",
                   "video_id": "16565363",
               },
               "is_exist": true
           },
           "remark": "这个是关于关于化学的课程",
           "video_abstract": "这个是生草啊啊啊啊啊啊啊",
           "content": "生草化学不生草",
           "tags": [
               "化学",
               "有机物",
               "科学课"
           ],
           "labels": [
               {
                   "id": "57066465",
                   "video_id": "16565363",
                   "start": 1.0,
                   "end": 2.0,
                   "body": "笨"
               },
               {
                   "id": "57060119",
                   "video_id": "16565363",
                   "start": 2.0,
                   "end": 3.0,
                   "body": "茚"
               },
               {
                   "id": "57062354",
                   "video_id": "16565363",
                   "start": 3.0,
                   "end": 4.0,
                   "body": "薁"
               },
               {
                   "id": "57068395",
                   "video_id": "16565363",
                   "start": 4.0,
                   "end": 5.0,
                   "body": "萘"
               },
               {
                   "id": "57063428",
                   "video_id": "16565363",
                   "start": 5.0,
                   "end": 6.0,
                   "body": "苊"
               },
               {
                   "id": "57060694",
                   "video_id": "16565363",
                   "start": 6.0,
                   "end": 7.0,
                   "body": "莒"
               }
           ],
           "is_exist": true,
                   "comments": [
               {
                   "id": "27766577",
                "body": "评论测试7",
                   "reviewer": "Nick",
                   "profile_picture": "profile_picture/default.png",
                   "comment_time": "2022-08-29T11:27:51.000+00:00"
               },
               {
                   "id": "27989765",
                   "body": "评论测试6",
                   "reviewer": "Nick",
                   "profile_picture": "profile_picture/default.png",
                   "comment_time": "2022-08-29T11:27:49.000+00:00"
               },
               {
                   "id": "27001326",
                   "body": "评论测试5",
                   "reviewer": "Nick",
                   "profile_picture": "profile_picture/default.png",
                   "comment_time": "2022-08-29T11:27:47.000+00:00"
               },
               {
                   "id": "27767936",
                   "body": "评论测试4",
                   "reviewer": "Nick",
                   "profile_picture": "profile_picture/default.png",
                   "comment_time": "2022-08-29T11:27:45.000+00:00"
               },
               {
                   "id": "27507193",
                   "body": "评论测试3",
                   "reviewer": "Nick",
                   "profile_picture": "profile_picture/default.png",
                   "comment_time": "2022-08-29T11:27:42.000+00:00"
               }
           ]
       }
   }
   ```
   
   

## 4.自动生成视频的全文内容和摘要【GET/Param】/video/autoInfo【==需管理员权限==】

1. 请求参数：

   |     参数名     |                          参数含义                          |   类型   | 是否非空 |
   | :------------: | :--------------------------------------------------------: | :------: | :------: |
   |       id       |                          视频的id                          | 字符串型 |    是    |
   |    content     | 是否生成视频的全文内容，是为true，否为false（默认为false） |  布尔型  |    是    |
   | video_abstract |   是否生成视频的摘要，是为true，否为false（默认为false）   |  布尔型  |    是    |

2. 响应结果：

   |     参数名     |  参数含义  |   类型   | 是否非空 |
   | :------------: | :--------: | :------: | :------: |
   |     remark     | 视频的备注 | 字符串型 |    否    |
   | video_abstract | 视频的摘要 | 字符串型 |    否    |

3. 说明：
   1. 可以选择是生成全文内容还是摘要
   2. 生成全文内容的依据是视频中的音频部分（AI语音识别实现）
   3. 生成内容摘要的依据是视频的全文内容（注意：如果生成摘要时，视频的全文内容字段为空，则此时还会自动进行全文内容的生成并返回）
   4. 生成的结果还没有更新到相应的视频对象中，需要调用更新接口把生成的结果传入（生成的结果可以进行人工调整）

==待完善==

> 下面的两个接口应该返回视频的请求地址

## 5.查询浏览记录【GET/Param】/video/getHistories

1. 请求参数：

   | 参数名 |    参数含义    | 类型 | 是否非空 |
   | :----: | :------------: | :--: | :------: |
   |  page  | 页码，从1开始  | 整型 |    是    |
   |  size  | 每页的请求数量 | 整型 |    是    |


2. 响应数据：一个列表，列表的元素对象字段信息如下：

   |   参数名    |      参数含义      |        类型        | 是否非空 |
   | :---------: | :----------------: | :----------------: | :------: |
   |  video_id   |   浏览的视频的id   |      字符串型      |    是    |
   | video_title |      视频标题      |      字符串型      |    是    |
   |    cover    |      视频封面      | 字符串型（超链接） |    是    |
   |  uploader   |   视频上传者名称   |      字符串型      |    是    |
   | uploader_id |     上传者的id     |      字符串型      |    是    |
   |  progress   |      观看进度      |      浮点类型      |    是    |
   |    total    |       总时长       |      浮点类型      |    是    |
   |  play_time  |      播放时间      |     Timestamp      |    是    |
   |  is_exist   | 视频是否存在的标识 |      布尔类型      |    是    |
   
3. 请求示例：
![image-20220813225436194](接口文档v4.assets/查询浏览记录请求测试.png)
   
   ```json
   {
       "msg": "成功",
       "code": 200,
       "data": [
           {
               "video_id": "23967844",
               "video_title": "泛型的不变规则",
               "cover": "video_cover/16603790159301191303.png",
               "uploader": "Nick",
               "uploader_id": "44738467",
               "process": 5.0,
               "total": 100.0,
               "play_time": "2022-08-13T14:41:14.355+00:00",
               "is_exist": true
           },
           {
               "video_id": "16565363",
               "video_title": "生草化学",
               "cover": "video_cover/16603785789451275035.png",
               "uploader": "Nick",
               "uploader_id": "44738467",
               "process": 4.0,
               "total": 100.0,
               "play_time": "2022-08-13T14:40:47.762+00:00",
               "is_exist": true
           },
           {
               "video_id": "27215381",
               "video_title": "白洞课程",
               "cover": "video_cover/16603756654941954819.png",
               "uploader": "Nick",
               "uploader_id": "44738467",
               "process": 3.0,
               "total": 100.0,
               "play_time": "2022-08-13T14:40:39.673+00:00",
               "is_exist": true
           },
           {
               "video_id": "25210132",
               "video_title": "蚂蚁课程",
               "cover": "video_cover/16603755530761802544.png",
               "uploader": "Nick",
               "uploader_id": "44738467",
               "process": 2.0,
               "total": 100.0,
               "play_time": "2022-08-13T14:40:31.512+00:00",
               "is_exist": true
           },
           {
               "video_id": "24530483",
               "video_title": "时间课程",
               "cover": "video_cover/16603754782511895072.png",
               "uploader": "Nick",
               "uploader_id": "44738467",
               "process": 1.0,
               "total": 100.0,
               "play_time": "2022-08-13T14:36:38.392+00:00",
               "is_exist": true
           }
       ]
   }
   ```
   
   

## 6.查询收藏夹【GET/Param】/video/getFavorites

1. 请求参数：

   | 参数名 |    参数含义    | 类型 | 是否非空 |
   | :----: | :------------: | :--: | :------: |
   |  page  | 页码，从1开始  | 整型 |    是    |
   |  size  | 每页的请求数量 | 整型 |    是    |

2. 响应数据：一个列表，列表的元素对象字段信息如下：

   |    参数名    |      参数含义      |        类型        | 是否非空 |
   | :----------: | :----------------: | :----------------: | :------: |
   |   video_id   |       视频id       |      字符串型      |    是    |
   | collect_time |      收藏时间      |     Timestamp      |    是    |
   | video_title  |      视频标题      |      字符串型      |    是    |
   |    cover     |      视频封面      | 字符串型（超链接） |    是    |
   |   uploader   |     上传者名称     |      字符串型      |    是    |
   | uploader_id  |     上传者的id     |      字符串型      |    是    |
   |   is_exist   | 视频是否存在的标识 |      布尔类型      |    是    |

3. 请求示例：
![image-20220813225832878](接口文档v4.assets/查询收藏记录请求测试.png)
   
   ```json
   {
       "msg": "成功",
       "code": 200,
       "data": [
           {
               "video_id": "23967844",
               "collect_time": "2022-08-13T14:58:04.109+00:00",
               "video_title": "泛型的不变规则",
               "cover": "video_cover/16603790159301191303.png",
               "uploader": "Nick",
               "uploader_id": "44738467",
               "is_exist": true
           },
           {
               "video_id": "16565363",
               "collect_time": "2022-08-13T14:57:23.692+00:00",
               "video_title": "生草化学",
               "cover": "video_cover/16603785789451275035.png",
               "uploader": "Nick",
               "uploader_id": "44738467",
               "is_exist": true
           },
           {
               "video_id": "27215381",
               "collect_time": "2022-08-13T14:57:14.099+00:00",
               "video_title": "白洞课程",
               "cover": "video_cover/16603756654941954819.png",
               "uploader": "Nick",
               "uploader_id": "44738467",
               "is_exist": true
           },
           {
               "video_id": "25210132",
               "collect_time": "2022-08-13T14:57:08.478+00:00",
               "video_title": "蚂蚁课程",
               "cover": "video_cover/16603755530761802544.png",
               "uploader": "Nick",
               "uploader_id": "44738467",
               "is_exist": true
           },
           {
               "video_id": "24530483",
               "collect_time": "2022-08-13T14:55:57.530+00:00",
               "video_title": "时间课程",
               "cover": "video_cover/16603754782511895072.png",
               "uploader": "Nick",
               "uploader_id": "44738467",
               "is_exist": true
           }
       ]
   }
   ```

## 7.上传视频【POST/Form-data】/video/postVideo【==需管理员权限==】

1. 请求参数：

   |     参数名     |    参数含义    |     类型     | 是否非空 |
   | :------------: | :------------: | :----------: | :------: |
   |     video      |    视频文件    |     file     |    是    |
   |     cover      |      封面      |     file     |    是    |
   |     title      |   视频的标题   |   字符串型   |    是    |
   |   course_id    |   所属课程id   |   字符串型   |    否    |
   |     remark     |   视频的备注   |   字符串型   |    否    |
   | video_abstract |   视频的摘要   |   字符串型   |    否    |
   |    content     | 视频的内容全文 |   字符串型   |    否    |
   |      tags      |   视频的标签   | 字符串型数组 |    否    |

2. 响应数据：

   |     参数名     |       参数含义       |       类型       | 是否非空 |
   | :------------: | :------------------: | :--------------: | :------: |
   |       id       |       视频的id       |     字符串型     |    是    |
   |    uploader    |      上传者名称      |     字符串型     |    是    |
   |  uploader_id   |       上传者id       |     字符串型     |    是    |
   |     video      |    视频的请求地址    |     字符串型     |    是    |
   |     cover      | 视频的封面的请求地址 |     字符串型     |    是    |
   |  upload_time   |       上传时间       |    Timestamp     |    是    |
   |     title      |      视频的标题      |     字符串型     |    是    |
   |     remark     |      视频的备注      |     字符串型     |    否    |
   | video_abstract |      视频的摘要      |     字符串型     |    否    |
   |    content     |    视频的内容全文    |     字符串型     |    否    |
   |      tags      |      视频的标签      |   字符串型数组   |    否    |
   |     labels     |    视频的进度标签    | 进度标签类型数组 |    否    |
   |    is_exist    |  视频是否存在的标记  |      布尔型      |    是    |

3. 请求实例：
   ![image-20220813151044495](接口文档v4.assets/视频上传请求测试.png)



响应结果：

```json
{
    "msg": "成功",
    "code": 200,
    "data": {
        "id": "09330839",
        "uploader": "Nick",
        "uploader_id": "44738467",
        "video": "video/16603745389331690204.mp4",
        "cover": "video_cover/16603745414741592900.png",
        "upload_time": "2022-08-13T07:09:01.533+00:00",
        "title": "时间课程",
        "remark": "这个是关于关于时间的课程",
        "video_abstract": "这个是时间课程啊啊啊啊啊啊啊",
        "content": "分析时间倒流的可能性",
        "tags": [
            "信条",
            "时间",
            "熵",
            "科学课"
        ],
        "is_exist": true
    }
}
```





## 8.更新视频信息【PUT】/video/updateInfo【==需管理员权限==】

1. 请求参数：

   |     参数名     |    参数含义    |     类型     | 是否非空 |
   | :------------: | :------------: | :----------: | :------: |
   |       id       |    视频的id    |   字符串型   |    是    |
   |     video      |    视频文件    |     file     |    否    |
   |     cover      |    视频封面    |     file     |    否    |
   |     title      |   视频的标题   |   字符串型   |    否    |
   |   course_id    |   所属课程id   |   字符串型   |    否    |
   |     remark     |   视频的备注   |   字符串型   |    否    |
   | video_abstract |   视频的摘要   |   字符串型   |    否    |
   |    content     | 视频的内容全文 |   字符串型   |    否    |
   |      tags      |   视频的标签   | 字符串型数组 |    否    |

2. 响应数据：

   |   参数名    |       参数含义       |   类型    | 是否非空 |
   | :---------: | :------------------: | :-------: | :------: |
   |     id      |       视频的id       | 字符串型  |    是    |
   |  uploader   |      上传者名称      | 字符串型  |    是    |
   | uploader_id |       上传者id       | 字符串型  |    是    |
   |    video    |    视频的请求地址    | 字符串型  |    是    |
   |    cover    | 视频的封面的请求地址 | 字符串型  |    是    |
   | upload_time |       上传时间       | Timestamp |    是    |
   |    title    |      视频的标题      | 字符串型  |    是    |



## 9.给视频添加进度标签【PUT/JSON】/video/setLabels【==需管理员权限==】

> 对于视频进度标签独立一个接口处理，前端可以为管理员提供一个专门的界面，根据视频的进度来添加相应的进度标签

1. 请求参数：

   |     参数名     |     参数含义     |       类型       | 是否非空 |
   | :------------: | :--------------: | :--------------: | :------: |
   |       id       |     视频的id     |     字符串型     |    是    |
   |   new_labels   | 新添加的进度标签 | 进度标签类型数组 |    否    |
   | deleted_labels | 要删除的进度标签 | 进度标签类型数组 |    否    |
   | updated_labels | 要更新的进度标签 | 进度标签类型数组 |    否    |

2. 进度标签类型的字段介绍：

   | 参数名 |       参数含义       |   类型   | 是否非空 |
   | :----: | :------------------: | :------: | :------: |
   |   id   |       标签的id       | 字符串型 |    是    |
   | start  | 对应的进度的开始位置 |  浮点型  |    是    |
   |  end   | 对应的进度的结束位置 |  浮点型  |    是    |
   |  body  |       标签内容       | 字符串型 |    是    |
   
   > 进度标签的意义就是标注出视频的每一段进度所对应的知识点，之后是可以根据进度标签进行检索，从而定位到具体视频的位置

3. 响应数据：
   一个进度标签类型的数组

4. 请求示例：
   **添加进度标签**

   ```json
   //请求
   {
       "id":"16565363",
       "new_labels":[
           {
               "start":1.0,
               "end":2.0,
               "body":"笨"
           },
           {
               "start":2.0,
               "end":3.0,
               "body":"茚"
           },
           {
               "start":3.0,
               "end":4.0,
               "body":"薁"
           },
           {
               "start":4.0,
               "end":5.0,
               "body":"萘"
           },
           {
               "start":5.0,
               "end":6.0,
               "body":"苊"
           },
           {
               "start":6.0,
               "end":7.0,
               "body":"莒"
           },
           {
               "start":7.0,
               "end":8.0,
               "body":"芴"
           }
       ]
   }
   //响应
   {
       "msg": "成功",
       "code": 200,
       "data": [
           {
               "id": "57066465",
               "video_id": "16565363",
               "start": 1.0,
               "end": 2.0,
               "body": "笨"
           },
           {
               "id": "57060119",
               "video_id": "16565363",
               "start": 2.0,
               "end": 3.0,
               "body": "茚"
           },
           {
               "id": "57062354",
               "video_id": "16565363",
               "start": 3.0,
               "end": 4.0,
               "body": "薁"
           },
           {
               "id": "57068395",
               "video_id": "16565363",
               "start": 4.0,
               "end": 5.0,
               "body": "萘"
           },
           {
               "id": "57063428",
               "video_id": "16565363",
               "start": 5.0,
               "end": 6.0,
               "body": "苊"
           },
           {
               "id": "57060694",
               "video_id": "16565363",
               "start": 6.0,
               "end": 7.0,
               "body": "莒"
           },
           {
               "id": "57066387",
               "video_id": "16565363",
               "start": 7.0,
               "end": 8.0,
               "body": "芴"
           }
       ]
   }
   ```

   **更新进度标签**

   ```json
   //请求
   {
       "id":"16565363",
       "updated_labels":[
           {
               "id": "57066387",
               "start":8.0,
               "end":9.0,
               "body":"芴1"
           }
       ]
   }
   //响应
   {
       "msg": "成功",
       "code": 200,
       "data": [
           {
               "id": "57066465",
               "video_id": "16565363",
               "start": 1.0,
               "end": 2.0,
               "body": "笨"
           },
           {
               "id": "57060119",
               "video_id": "16565363",
               "start": 2.0,
               "end": 3.0,
               "body": "茚"
           },
           {
               "id": "57062354",
               "video_id": "16565363",
               "start": 3.0,
               "end": 4.0,
               "body": "薁"
           },
           {
               "id": "57068395",
               "video_id": "16565363",
               "start": 4.0,
               "end": 5.0,
               "body": "萘"
           },
           {
               "id": "57063428",
               "video_id": "16565363",
               "start": 5.0,
               "end": 6.0,
               "body": "苊"
           },
           {
               "id": "57060694",
               "video_id": "16565363",
               "start": 6.0,
               "end": 7.0,
               "body": "莒"
           },
           {
               "id": "57066387",
               "video_id": "16565363",
               "start": 8.0,
               "end": 9.0,
               "body": "芴1"
           }
       ]
   }
   ```

   **删除进度标签**

   ```json
   //请求
   {
       "id":"16565363",
       "deleted_labels":[
           {
               "id": "57066387"
           }
       ]
   }
   //响应
   {
       "msg": "成功",
       "code": 200,
       "data": [
           {
               "id": "57066465",
               "video_id": "16565363",
               "start": 1.0,
               "end": 2.0,
               "body": "笨"
           },
           {
               "id": "57060119",
               "video_id": "16565363",
               "start": 2.0,
               "end": 3.0,
               "body": "茚"
           },
           {
               "id": "57062354",
               "video_id": "16565363",
               "start": 3.0,
               "end": 4.0,
               "body": "薁"
           },
           {
               "id": "57068395",
               "video_id": "16565363",
               "start": 4.0,
               "end": 5.0,
               "body": "萘"
           },
           {
               "id": "57063428",
               "video_id": "16565363",
               "start": 5.0,
               "end": 6.0,
               "body": "苊"
           },
           {
               "id": "57060694",
               "video_id": "16565363",
               "start": 6.0,
               "end": 7.0,
               "body": "莒"
           }
       ]
   }
   ```

   



## 10.收藏视频【PUT/Param】/video/setFavorite

1. 请求参数：

   | 参数名 | 参数含义 |   类型   | 是否非空 |
   | :----: | :------: | :------: | :------: |
   |   id   | 视频的id | 字符串型 |    是    |

2. 相应数据：

   无
   
3. 请求示例：
   ![image-20220813225618963](接口文档v4.assets/收藏视频请求测试.png)

   ```json
   {
       "msg": "成功",
       "code": 200,
       "data": null
   }
   ```

   



## 11.设置浏览记录【PUT/Param】/video/setHistory

1. 请求参数：

   | 参数名  |     参数含义     |   类型   | 是否非空 |
   | :-----: | :--------------: | :------: | :------: |
   |   id    |     视频的id     | 字符串型 |    是    |
   | process | 关闭视频时的进度 |  浮点型  |    是    |
   |  total  |   视频的总长度   |  浮点型  |    是    |

2. 响应数据：

   无

3. 请求示例：
   ![image-20220813223720193](接口文档v4.assets/设置浏览记录请求测试.png)

   ```json
   {
       "msg": "成功",
       "code": 200,
       "data": null
   }
   ```

4. 关于该接口的说明：当用户关闭某个视频时，需要调用该接口告知后端关于用户的浏览记录情况（即观看到哪个位置）





## 11.删除浏览记录【DELETE/Param】/video/deleteHistories

1. 请求参数：

   | 参数名 |   参数含义   |   类型   | 是否非空 |
   | :----: | :----------: | :------: | :------: |
   |   id   |   视频的id   | 字符串型 |    否    |
   |  ids   | 视频的id集合 |   列表   |    否    |

   > 可以选择传入一个id只删除一条记录，也可以选择传入一个id的集合删除多条记录（二选一即可），下同

2. 响应参数：无

3. 请求示例：
   ![image-20220813233953510](接口文档v4.assets/删除浏览记录请求测试.png)

   ```json
   {
       "msg": "成功",
       "code": 200,
       "data": null
   }
   ```

   




## 12.删除收藏内容【DELETE/Param】/video/deleteFavorites

1. 请求参数：

   | 参数名 |   参数含义   |   类型   | 是否非空 |
   | :----: | :----------: | :------: | :------: |
   |   id   |   视频的id   | 字符串型 |    否    |
   |  ids   | 视频的id集合 |   列表   |    否    |

2. 响应参数：无

3. 请求示例：
   ![image-20220813234108216](接口文档v4.assets/删除收藏内容请求测试.png)

   ```json
   {
       "msg": "成功",
       "code": 200,
       "data": null
   }
   ```

   

   

## 13.删除视频【DELETE/Param】/video/deleteVideos【==需管理员权限==】

1. 请求参数：

   | 参数名 |   参数含义   |   类型   | 是否非空 |
   | :----: | :----------: | :------: | :------: |
   |   id   |   视频的id   | 字符串型 |    否    |
   |  ids   | 视频的id集合 |   列表   |    否    |

2. 响应参数：无

3. 请求示例：
   ![image-20220813234456236](接口文档v4.assets/删除视频请求测试.png)

   ```json
   {
       "msg": "成功",
       "code": 200,
       "data": null
   }
   ```

   视频删除完之后，再去查询该视频的信息则显示：

   ```json
   {
       "msg": "成功",
       "code": 200,
       "data": {
           "id": "24530483",
           "uploader": null,
           "uploader_id": null,
           "video": null,
           "cover": null,
           "upload_time": null,
           "title": null,
           "course": null,
           "remark": null,
           "video_abstract": null,
           "content": null,
           "tags": null,
           "labels": null,
           "is_exist": false
       }
   }
   ```

   `is_exist`标记的值变为了false

   同样，如查询的浏览记录或收藏记录包含被删除的视频，则对应视频对象的`is_exist`标记的值也会变为false：

   ```json
   {
       "msg": "成功",
       "code": 200,
       "data": [
           {
               "video_id": "27215381",
               "video_title": "白洞课程",
               "cover": "video_cover/16603756654941954819.png",
               "uploader": "Nick",
               "uploader_id": "44738467",
               "process": 3.0,
               "total": 100.0,
               "play_time": "2022-08-13T14:40:39.673+00:00",
               "is_exist": true
           },
           {
               "video_id": "25210132",
               "video_title": "蚂蚁课程",
               "cover": "video_cover/16603755530761802544.png",
               "uploader": "Nick",
               "uploader_id": "44738467",
               "process": 2.0,
               "total": 100.0,
               "play_time": "2022-08-13T14:40:31.512+00:00",
               "is_exist": true
           },
           {
               "video_id": "24530483",
               "video_title": null,
               "cover": null,
               "uploader": null,
               "uploader_id": null,
               "process": null,
               "total": null,
               "play_time": null,
               "is_exist": false
           }
       ]
   }
   ```

   而且，在该视频所在的课程中，对应该课程的标签也会被删除

   ```json
   {
       "msg": "成功",
       "code": 200,
       "data": {
           "id": "22593815",
           "remark": "科学课111",
           "course_abstract": "这个是科学课啊啊啊啊啊啊啊111",
           "catalog": [
               {
                   "id": "31050678",
                   "body": "化学相关",
                   "level_id": "1",
                   "next": [
                       {
                           "id": "31055673",
                           "body": "生草化学",
                           "level_id": "1.1",
                           "video_id": "16565363",
                           "video_title": "生草化学"
                       },
                       {
                           "id": "31066611",
                           "body": "化学基础知识",
                           "level_id": "1.2",
                           "next": []
                       },
                       {
                           "id": "31068755",
                           "body": "化学高级知识",
                           "level_id": "1.3",
                           "next": []
                       }
                   ]
               },
               {
                   "id": "31061426",
                   "body": "天文知识",
                   "level_id": "2",
                   "next": [
                       {
                           "id": "31062116",
                           "body": "白洞课程",
                           "level_id": "2.1",
                           "video_id": "27215381",
                           "video_title": "白洞课程"
                       },
                       {
                           "id": "31060083",
                           "body": "宇宙基础知识",
                           "level_id": "2.2",
                           "next": []
                       },
                       {
                           "id": "31068247",
                           "body": "宇宙高级知识",
                           "level_id": "2.3",
                           "next": []
                       }
                   ]
               },
               {
                   "id": "31067567",
                   "body": "生物知识",
                   "level_id": "3",
                   "next": [
                       {
                           "id": "31069605",
                           "body": "蚂蚁课程",
                           "level_id": "3.1",
                           "video_id": "25210132",
                           "video_title": "蚂蚁课程"
                       },
                       {
                           "id": "31069624",
                           "body": "生物基础知识",
                           "level_id": "3.2",
                           "next": []
                       },
                       {
                           "id": "31069955",
                           "body": "生物高级知识",
                           "level_id": "3.3",
                           "next": []
                       }
                   ]
               },
               {
                   "id": "31071829",
                   "body": "物理知识",
                   "level_id": "4",
                   "next": [
                       //视频所对应的章节标签的level_id为4.1，该章节标签已经被删除了
                       {
                           "id": "31071801",
                           "body": "物理基础知识",
                           "level_id": "4.2",
                           "next": []
                       },
                       {
                           "id": "31075432",
                           "body": "物理高级知识",
                           "level_id": "4.3",
                           "next": []
                       }
                   ]
               }
           ],
           "chapter": null,
           "is_exist": true
       }
   }
   ```

   



# 八、课程模块

## 1.查询课程的完整信息【GET/Param】/course/getInfo

1. 请求参数：

   |     参数名      |                           参数含义                           |   类型   | 是否非空 |
   | :-------------: | :----------------------------------------------------------: | :------: | :------: |
   |       id        |                           课程的id                           | 字符串型 |    是    |
   |     remark      |    是否查询remark字段，是为true，否为false（默认为false）    |  布尔型  |    是    |
   | course_abstract | 是否查询course_abstract字段，是为true，否为false（默认为false） |  布尔型  |    是    |
   |     catalog     |   是否查询catalog字段，是为true，否为false（默认为false）    |  布尔型  |    是    |

2. 响应数据：

   |     参数名      |       参数含义       |     类型     | 是否非空 |
   | :-------------: | :------------------: | :----------: | :------: |
   |       id        |       课程的id       |   字符串型   |    是    |
   |      title      |      课程的标题      |   字符串型   |    是    |
   |      cover      | 课程的封面的请求地址 |   字符串型   |    是    |
   |   create_time   |    课程的创建时间    |  Timestamp   |    是    |
   |     author      |     课程的创建者     |   字符串型   |    是    |
   |    author_id    |   课程的创建者的id   |   字符串型   |    是    |
   |     remark      |      课程的备注      |   字符串型   |    否    |
   | course_abstract |      课程的摘要      |   字符串型   |    否    |
   |     catalog     |      课程的目录      | 章节类型数组 |    否    |
   |    is_exist     |  课程是否存在的标识  |   布尔类型   |    是    |

3. 章节类型的字段介绍：

   |   参数名    |     参数含义     |                    类型                    | 是否非空 |
   | :---------: | :--------------: | :----------------------------------------: | :------: |
   |     id      |     章节的id     |                  字符串型                  |    是    |
   |  level_id   |  所属章节的层级  | 字符串型（形式如：`1`、``1.1`、`2.1.2`等） |    是    |
   |    body     |  所属章节的标题  |                  字符串型                  |    是    |
   |  video_id   |   对应视频的id   |                  字符串型                  |    否    |
   | video_title |  对应视频的标题  |                  字符串型                  |    否    |
   |    next     | 下一级的章节集合 |               章节类型的数组               |    否    |

   > 章节类型至少有两种，一种是不对应任何视频，仅仅起到分类的作用（类比于文件夹）；另一种对应了具体的视频，可以根据视频的id进行导航（类比于文件）

4. 请求测试：
   ![image-20220813211902451](接口文档v4.assets/查询课程完整信息请求测试.png)

   ```json
   {
       "msg": "成功",
       "code": 200,
       "data": {
           "id": "22593815",
           "title": "科学课",
           "cover": "course_cover/16603753619681417958.png",
           "create_time": "2022-08-13T07:22:42.160+00:00",
           "author": "Nick",
           "author_id": "44738467",
           "remark": "科学课",
           "course_abstract": "这个是科学课啊啊啊啊啊啊啊",
           "catalog": [
               {
                   "id": "31050678",
                   "body": "化学相关",
                   "level_id": "1",
                   "next": [
                       {
                           "id": "31055673",
                           "body": "生草化学",
                           "level_id": "1.1",
                           "video_id": "16565363",
                           "video_title": "生草化学"
                       },
                       {
                           "id": "31066611",
                           "body": "化学基础知识",
                           "level_id": "1.2",
                           "next": []
                       },
                       {
                           "id": "31068755",
                           "body": "化学高级知识",
                           "level_id": "1.3",
                           "next": []
                       }
                   ]
               },
               {
                   "id": "31061426",
                   "body": "天文知识",
                   "level_id": "2",
                   "next": [
                       {
                           "id": "31062116",
                           "body": "白洞课程",
                           "level_id": "2.1",
                           "video_id": "27215381",
                           "video_title": "白洞课程"
                       },
                       {
                           "id": "31060083",
                           "body": "宇宙基础知识",
                           "level_id": "2.2",
                           "next": []
                       },
                       {
                           "id": "31068247",
                           "body": "宇宙高级知识",
                           "level_id": "2.3",
                           "next": []
                       }
                   ]
               },
               {
                   "id": "31067567",
                   "body": "生物知识",
                   "level_id": "3",
                   "next": [
                       {
                           "id": "31069605",
                           "body": "蚂蚁课程",
                           "level_id": "3.1",
                           "video_id": "25210132",
                           "video_title": "蚂蚁课程"
                       },
                       {
                           "id": "31069624",
                           "body": "生物基础知识",
                           "level_id": "3.2",
                           "next": []
                       },
                       {
                           "id": "31069955",
                           "body": "生物高级知识",
                           "level_id": "3.3",
                           "next": []
                       }
                   ]
               },
               {
                   "id": "31071829",
                   "body": "物理知识",
                   "level_id": "4",
                   "next": [
                       {
                           "id": "31078072",
                           "body": "时间课程",
                           "level_id": "4.1",
                           "video_id": "24530483",
                           "video_title": "时间课程"
                       },
                       {
                           "id": "31071801",
                           "body": "物理基础知识",
                           "level_id": "4.2",
                           "next": []
                       },
                       {
                           "id": "31075432",
                           "body": "物理高级知识",
                           "level_id": "4.3",
                           "next": []
                       }
                   ]
               }
           ],
           "is_exist": true
       }
   }
   ```

   

## 2.查询课程的部分信息【GET/Param】/course/getInfoField

1. 请求参数：

   |     参数名      |                           参数含义                           |   类型   | 是否非空 |
   | :-------------: | :----------------------------------------------------------: | :------: | :------: |
   |       id        |                           课程的id                           | 字符串型 |    是    |
   |     remark      |    是否查询remark字段，是为true，否为false（默认为false）    |  布尔型  |    是    |
   | course_abstract | 是否查询course_abstract字段，是为true，否为false（默认为false） |  布尔型  |    是    |
   |     catalog     |   是否查询catalog字段，是为true，否为false（默认为false）    |  布尔型  |    是    |

2. 响应数据：

   |     参数名      |      参数含义      |     类型     | 是否非空 |
   | :-------------: | :----------------: | :----------: | :------: |
   |     remark      |     课程的备注     |   字符串型   |    否    |
   | course_abstract |     课程的摘要     |   字符串型   |    否    |
   |     catalog     |     课程的目录     | 章节类型数组 |    否    |
   |    is_exist     | 课程是否存在的标识 |   布尔类型   |    是    |

3. 请求示例：
   ![image-20220813214126432](接口文档v4.assets/查询课程部分信息请求测试.png)

   ```json
   {
       "msg": "成功",
       "code": 200,
       "data": {
           "id": "22593815",
           "remark": "科学课",
           "course_abstract": "这个是科学课啊啊啊啊啊啊啊",
           "catalog": [
               {
                   "id": "31050678",
                   "body": "化学相关",
                   "level_id": "1",
                   "next": [
                       {
                           "id": "31055673",
                           "body": "生草化学",
                           "level_id": "1.1",
                           "video_id": "16565363",
                           "video_title": "生草化学"
                       },
                       {
                           "id": "31066611",
                           "body": "化学基础知识",
                           "level_id": "1.2",
                           "next": []
                       },
                       {
                           "id": "31068755",
                           "body": "化学高级知识",
                           "level_id": "1.3",
                           "next": []
                       }
                   ]
               },
               {
                   "id": "31061426",
                   "body": "天文知识",
                   "level_id": "2",
                   "next": [
                       {
                           "id": "31062116",
                           "body": "白洞课程",
                           "level_id": "2.1",
                           "video_id": "27215381",
                           "video_title": "白洞课程"
                       },
                       {
                           "id": "31060083",
                           "body": "宇宙基础知识",
                           "level_id": "2.2",
                           "next": []
                       },
                       {
                           "id": "31068247",
                           "body": "宇宙高级知识",
                           "level_id": "2.3",
                           "next": []
                       }
                   ]
               },
               {
                   "id": "31067567",
                   "body": "生物知识",
                   "level_id": "3",
                   "next": [
                       {
                           "id": "31069605",
                           "body": "蚂蚁课程",
                           "level_id": "3.1",
                           "video_id": "25210132",
                           "video_title": "蚂蚁课程"
                       },
                       {
                           "id": "31069624",
                           "body": "生物基础知识",
                           "level_id": "3.2",
                           "next": []
                       },
                       {
                           "id": "31069955",
                           "body": "生物高级知识",
                           "level_id": "3.3",
                           "next": []
                       }
                   ]
               },
               {
                   "id": "31071829",
                   "body": "物理知识",
                   "level_id": "4",
                   "next": [
                       {
                           "id": "31078072",
                           "body": "时间课程",
                           "level_id": "4.1",
                           "video_id": "24530483",
                           "video_title": "时间课程"
                       },
                       {
                           "id": "31071801",
                           "body": "物理基础知识",
                           "level_id": "4.2",
                           "next": []
                       },
                       {
                           "id": "31075432",
                           "body": "物理高级知识",
                           "level_id": "4.3",
                           "next": []
                       }
                   ]
               }
           ],
           "is_exist": true
       }
   }
   ```

   



## 3.添加课程【POST/Form-data】/course/addCourse【==需管理员权限==】

1. 请求参数：

   |     参数名      |  参数含义  |   类型   | 是否非空 |
   | :-------------: | :--------: | :------: | :------: |
   |      cover      |  封面图片  |   file   |    是    |
   |      title      | 课程的标题 | 字符串型 |    是    |
   |     remark      | 课程的备注 | 字符串型 |    否    |
   | course_abstract | 课程的摘要 | 字符串型 |    否    |
   
2. 响应数据：

   |     参数名      |       参数含义       |     类型     | 是否非空 |
   | :-------------: | :------------------: | :----------: | :------: |
   |       id        |       课程的id       |   字符串型   |    是    |
   |      title      |      课程的标题      |   字符串型   |    是    |
   |      cover      | 课程的封面的请求地址 |   字符串型   |    是    |
   |   create_time   |    课程的创建时间    |  Timestamp   |    是    |
   |     author      |     课程的创建者     |   字符串型   |    是    |
   |    author_id    |   课程的创建者的id   |   字符串型   |    是    |
   |     remark      |      课程的备注      |   字符串型   |    否    |
   | course_abstract |      课程的摘要      |   字符串型   |    否    |
   |     catalog     |      课程的目录      | 章节类型数组 |    否    |

3. 请求示例：

   ![image-20220813152119194](接口文档v4.assets/添加课程请求测试.png)

响应结果：

```json
{
    "msg": "成功",
    "code": 200,
    "data": {
        "id": "20578435",
        "title": "少儿英语培训班",
        "cover": "course_cover/16603752529431976532.png",
        "create_time": "2022-08-13T07:20:53.157+00:00",
        "author": "Nick",
        "author_id": "44738467",
        "remark": "少儿英语培训班",
        "course_abstract": "这个是少儿英语培训班啊啊啊啊啊啊啊",
        "catalog": null,
        "chapter": null,
        "is_exist": true
    }
}
```





## 4.修改课程【POST/Form-data】/course/updateInfo【==需管理员权限==】

1. 请求参数：

   |     参数名      |  参数含义  |   类型   | 是否非空 |
   | :-------------: | :--------: | :------: | :------: |
   |       id        |  课程的id  | 字符串型 |    是    |
   |      cover      |  封面图片  |   file   |    否    |
   |      title      | 课程的标题 | 字符串型 |    否    |
   |     remark      | 课程的备注 | 字符串型 |    否    |
   | course_abstract | 课程的摘要 | 字符串型 |    否    |

2. 响应数据：

   |   参数名    |       参数含义       |   类型    | 是否非空 |
   | :---------: | :------------------: | :-------: | :------: |
   |     id      |       课程的id       | 字符串型  |    是    |
   |    title    |      课程的标题      | 字符串型  |    是    |
   |    cover    | 课程的封面的请求地址 | 字符串型  |    是    |
   | create_time |    课程的创建时间    | Timestamp |    是    |
   |   author    |     课程的创建者     | 字符串型  |    是    |
   |  author_id  |   课程的创建者的id   | 字符串型  |    是    |
   |  is_exist   |  课程是否存在的标识  | 布尔类型  |    是    |

3. 请求示例：

   ![](接口文档v4.assets/更新课程信息请求测试.png)

   ```json
   {
       "msg": "成功",
       "code": 200,
       "data": {
           "id": "22593815",
           "title": "科学课111",
           "cover": "course_cover/16603753619681417958.png",
           "create_time": "2022-08-13T07:22:42.160+00:00",
           "author": "Nick",
           "author_id": "44738467",
           "is_exist": true
       }
   }
   ```

   > 只响应基础信息





## 5.给课程添加章节目录【PUT/JSON】/course/setChapters【==需管理员权限==】

1. 请求参数：

   |      参数名      |   参数含义   |     类型     | 是否非空 |
   | :--------------: | :----------: | :----------: | :------: |
   |        id        |   视频的id   |   字符串型   |    是    |
   |   new_chapters   | 新添加的章节 | 章节类型数组 |    否    |
   | deleted_chapters | 要删除的章节 | 章节类型数组 |    否    |
   | updated_chapters | 要更新的章节 | 章节类型数组 |    否    |

2. 章节类型的字段介绍：

   |   参数名    |             参数含义             |            类型             | 是否非空 |
   | :---------: | :------------------------------: | :-------------------------: | :------: |
   |     id      |             章节的id             |          字符串型           |    否    |
   |  level_id   |          所属章节的层级          | 字符串型（用`.`来进行分割） |    是    |
   |    body     |          所属章节的标题          |          字符串型           |    是    |
   |  video_id   |           对应视频的id           |          字符串型           |    否    |
   | video_title |         对应的视频的标题         |          字符串型           |    否    |
   |    next     | 隶属于该章节的下一级的章节的集合 |        章节类型数组         |    否    |
   
   > 1. 说明：level_id的形式如：`“1”`、`“1.1”`、`“1.1.2”`，这种由数字和`.`构成的字符串，可以用于说明标签之间的层级关系（如：`1.1`是`1`的下一层，`1.1.2`又是`1.1`的下一层）
   > 2. 至少有两种类型的章节对象：一种是对应于某一视频的章节对象（有video_id、video_title字段，无next字段），相当于是文件；还有一种章节类型是对应于知识点范围的（无video_id、video_title字段，有next字段），相当于是文件夹
   > 3. 在创建章节时不需要传入章节对象的id（由后端自行分配），前端可以依据该接口返回的章节类型数组重新渲染课程的章节目录
   
3. 响应结果：
   该课程的目录（一个章节类型的数组）

4. 请求示例：
   **添加章节目录**

   ```json
   //请求
   {
       "id":"22593815",
       "new_chapters":[
           {
               "level_id":"1",
               "body":"化学相关"
           },
           {
               "level_id":"1.1",
               "body":"生草花学（有错别字）",
               "video_id":"16565363"
           },
           {
               "level_id":"1.2",
               "body":"化学基础知识"
           },
           {
               "level_id":"1.3",
               "body":"化学高级知识"
           },
           {
               "level_id":"2",
               "body":"天文知识"
           },
           {
               "level_id":"2.1",
               "body":"白洞课程",
               "video_id":"27215381"
           },
           {
               "level_id":"2.2",
               "body":"宇宙基础知识"
           },
           {
               "level_id":"2.3",
               "body":"宇宙高级知识"
           },
           {
               "level_id":"3",
               "body":"生物知识"
           },
           {
               "level_id":"3.1",
               "body":"蚂蚁课程",
               "video_id":"25210132"
           },
           {
               "level_id":"3.2",
               "body":"生物基础知识"
           },
           {
               "level_id":"3.3",
               "body":"生物高级知识"
           },
           {
               "level_id":"3.3.1",
               "body":"乱入的编程课程",
               "video_id":"23967844"
           },
           {
               "level_id":"4",
               "body":"物理知识"
           },
           {
               "level_id":"4.1",
               "body":"时间课程",
               "video_id":"24530483"
           },
           {
               "level_id":"4.2",
               "body":"物理基础知识"
           },
           {
               "level_id":"4.3",
               "body":"物理高级知识"
           }
       ]
   }
   //响应
   {
       "msg": "成功",
       "code": 200,
       "data": [
           {
               "id": "31050678",
               "body": "化学相关",
               "level_id": "1",
               "next": [
                   {
                       "id": "31055673",
                       "body": "生草花学（有错别字）",
                       "level_id": "1.1",
                       "video_id": "16565363",
                       "video_title": "生草化学"
                   },
                   {
                       "id": "31066611",
                       "body": "化学基础知识",
                       "level_id": "1.2",
                       "next": []
                   },
                   {
                       "id": "31068755",
                       "body": "化学高级知识",
                       "level_id": "1.3",
                       "next": []
                   }
               ]
           },
           {
               "id": "31061426",
               "body": "天文知识",
               "level_id": "2",
               "next": [
                   {
                       "id": "31062116",
                       "body": "白洞课程",
                       "level_id": "2.1",
                       "video_id": "27215381",
                       "video_title": "白洞课程"
                   },
                   {
                       "id": "31060083",
                       "body": "宇宙基础知识",
                       "level_id": "2.2",
                       "next": []
                   },
                   {
                       "id": "31068247",
                       "body": "宇宙高级知识",
                       "level_id": "2.3",
                       "next": []
                   }
               ]
           },
           {
               "id": "31067567",
               "body": "生物知识",
               "level_id": "3",
               "next": [
                   {
                       "id": "31069605",
                       "body": "蚂蚁课程",
                       "level_id": "3.1",
                       "video_id": "25210132",
                       "video_title": "蚂蚁课程"
                   },
                   {
                       "id": "31069624",
                       "body": "生物基础知识",
                       "level_id": "3.2",
                       "next": []
                   },
                   {
                       "id": "31069955",
                       "body": "生物高级知识",
                       "level_id": "3.3",
                       "next": [
                           {
                               "id": "31078739",
                               "body": "乱入的编程课程",
                               "level_id": "3.3.1",
                               "video_id": "23967844",
                               "video_title": "泛型的不变规则"
                           }
                       ]
                   }
               ]
           },
           {
               "id": "31071829",
               "body": "物理知识",
               "level_id": "4",
               "next": [
                   {
                       "id": "31078072",
                       "body": "时间课程",
                       "level_id": "4.1",
                       "video_id": "24530483",
                       "video_title": "时间课程"
                   },
                   {
                       "id": "31071801",
                       "body": "物理基础知识",
                       "level_id": "4.2",
                       "next": []
                   },
                   {
                       "id": "31075432",
                       "body": "物理高级知识",
                       "level_id": "4.3",
                       "next": []
                   }
               ]
           }
       ]
   }
   ```

   **删除章节**

   ```json
   //请求
   {
       "id":"22593815",
       "deleted_chapters":[
           {
               "id":"31078739",
               "level_id":"3.3.1"//level_id也要传入
           }
       ]
   }
   //响应
   {
       "msg": "成功",
       "code": 200,
       "data": [
           {
               "id": "31050678",
               "body": "化学相关",
               "level_id": "1",
               "next": [
                   {
                       "id": "31055673",
                       "body": "生草花学（有错别字）",
                       "level_id": "1.1",
                       "video_id": "16565363",
                       "video_title": "生草化学"
                   },
                   {
                       "id": "31066611",
                       "body": "化学基础知识",
                       "level_id": "1.2",
                       "next": []
                   },
                   {
                       "id": "31068755",
                       "body": "化学高级知识",
                       "level_id": "1.3",
                       "next": []
                   }
               ]
           },
           {
               "id": "31061426",
               "body": "天文知识",
               "level_id": "2",
               "next": [
                   {
                       "id": "31062116",
                       "body": "白洞课程",
                       "level_id": "2.1",
                       "video_id": "27215381",
                       "video_title": "白洞课程"
                   },
                   {
                       "id": "31060083",
                       "body": "宇宙基础知识",
                       "level_id": "2.2",
                       "next": []
                   },
                   {
                       "id": "31068247",
                       "body": "宇宙高级知识",
                       "level_id": "2.3",
                       "next": []
                   }
               ]
           },
           {
               "id": "31067567",
               "body": "生物知识",
               "level_id": "3",
               "next": [
                   {
                       "id": "31069605",
                       "body": "蚂蚁课程",
                       "level_id": "3.1",
                       "video_id": "25210132",
                       "video_title": "蚂蚁课程"
                   },
                   {
                       "id": "31069624",
                       "body": "生物基础知识",
                       "level_id": "3.2",
                       "next": []
                   },
                   {
                       "id": "31069955",
                       "body": "生物高级知识",
                       "level_id": "3.3",
                       "next": []
                   }
               ]
           },
           {
               "id": "31071829",
               "body": "物理知识",
               "level_id": "4",
               "next": [
                   {
                       "id": "31078072",
                       "body": "时间课程",
                       "level_id": "4.1",
                       "video_id": "24530483",
                       "video_title": "时间课程"
                   },
                   {
                       "id": "31071801",
                       "body": "物理基础知识",
                       "level_id": "4.2",
                       "next": []
                   },
                   {
                       "id": "31075432",
                       "body": "物理高级知识",
                       "level_id": "4.3",
                       "next": []
                   }
               ]
           }
       ]
   }
   ```

   **更新章节**

   ```json
   //请求
   {
       "id":"22593815",
       "updated_chapters":[
           {
               "id":"31055673",
               "body":"生草化学"//要修改body字段就传入body字段，要修改level_id字段就传入level_id字段（可以选择性传入）
           }
       ]
   }
   //响应
   {
       "msg": "成功",
       "code": 200,
       "data": [
           {
               "id": "31050678",
               "body": "化学相关",
               "level_id": "1",
               "next": [
                   {
                       "id": "31055673",
                       "body": "生草化学",
                       "level_id": "1.1",
                       "video_id": "16565363",
                       "video_title": "生草化学"//改过来了
                   },
                   {
                       "id": "31066611",
                       "body": "化学基础知识",
                       "level_id": "1.2",
                       "next": []
                   },
                   {
                       "id": "31068755",
                       "body": "化学高级知识",
                       "level_id": "1.3",
                       "next": []
                   }
               ]
           },
           {
               "id": "31061426",
               "body": "天文知识",
               "level_id": "2",
               "next": [
                   {
                       "id": "31062116",
                       "body": "白洞课程",
                       "level_id": "2.1",
                       "video_id": "27215381",
                       "video_title": "白洞课程"
                   },
                   {
                       "id": "31060083",
                       "body": "宇宙基础知识",
                       "level_id": "2.2",
                       "next": []
                   },
                   {
                       "id": "31068247",
                       "body": "宇宙高级知识",
                       "level_id": "2.3",
                       "next": []
                   }
               ]
           },
           {
               "id": "31067567",
               "body": "生物知识",
               "level_id": "3",
               "next": [
                   {
                       "id": "31069605",
                       "body": "蚂蚁课程",
                       "level_id": "3.1",
                       "video_id": "25210132",
                       "video_title": "蚂蚁课程"
                   },
                   {
                       "id": "31069624",
                       "body": "生物基础知识",
                       "level_id": "3.2",
                       "next": []
                   },
                   {
                       "id": "31069955",
                       "body": "生物高级知识",
                       "level_id": "3.3",
                       "next": []
                   }
               ]
           },
           {
               "id": "31071829",
               "body": "物理知识",
               "level_id": "4",
               "next": [
                   {
                       "id": "31078072",
                       "body": "时间课程",
                       "level_id": "4.1",
                       "video_id": "24530483",
                       "video_title": "时间课程"
                   },
                   {
                       "id": "31071801",
                       "body": "物理基础知识",
                       "level_id": "4.2",
                       "next": []
                   },
                   {
                       "id": "31075432",
                       "body": "物理高级知识",
                       "level_id": "4.3",
                       "next": []
                   }
               ]
           }
       ]
   }
   ```

   > 注意：在更新章节时，若更新的为章节的`level_id`，则其子章节的`level_id`也会跟着改变（如：把`level_id`为`1.1`的章节的`level_id`改为`2.1`，则其会变成`level_id`为` 2`的章节的子章节，且该章节的子章节如`1.1.1`、`1.1.2`也会对应地改为`2.1.1`、`2.1.2`





## 5.删除课程【DELETE/Param】/course/deleteCourses【==需管理员权限==】

1. 请求参数：

   | 参数名 |   参数含义   |   类型   | 是否非空 |
   | :----: | :----------: | :------: | :------: |
   |   id   |   课程的id   | 字符串型 |    是    |
   |  ids   | 课程的id集合 |   列表   |    否    |

2. 响应数据：
   无
   
3. 请求示例：
   ![image-20220814001500766](接口文档v4.assets/删除课程请求测试.png)

   ```json
   {
       "msg": "成功",
       "code": 200,
       "data": null
   }
   ```

   此时再查询该课程，显示如下：

   ```json
   {
       "msg": "成功",
       "code": 200,
       "data": {
           "id": "22593815",
           "title": null,
           "cover": null,
           "create_time": null,
           "author": null,
           "author_id": null,
           "remark": null,
           "course_abstract": null,
           "catalog": null,
           "chapter": null,
           "is_exist": false
       }
   }
   ```

   与该课程相关的视频的course字段全部变为空，如：

   ```json
   {
       "msg": "成功",
       "code": 200,
       "data": {
           "id": "25210132",
           "uploader": "Nick",
           "uploader_id": "44738467",
           "video": "video/16603755518081009779.mp4",
           "cover": "video_cover/16603755530761802544.png",
           "upload_time": "2022-08-13T07:25:53.221+00:00",
           "title": "蚂蚁课程",
           "course": {
               "id": "22593815",
               "title": null,
               "cover": null,
               "create_time": null,
               "author": null,
               "author_id": null,
               "remark": null,
               "course_abstract": null,
               "catalog": null,
               "chapter": null,
               "is_exist": false
           },
           "remark": "这个是关于关于蚂蚁的课程",
           "video_abstract": "这个是蚂蚁课程啊啊啊啊啊啊啊",
           "content": "小蚂蚁有大智慧",
           "tags": [
               "蚂蚁",
               "科学课"
           ],
           "labels": [],
           "is_exist": true
       }
   }
   ```




# 九、资源请求模块

## 1.请求视频流【GET/Param】/oss/getVideo

1. 请求参数：

   | 参数名 | 参数含义 |   类型   | 是否非空 |
   | :----: | :------: | :------: | :------: |
   |   id   | 视频的id | 字符串型 |    是    |

2. 响应数据：
   视频流，可以用`<video>`标签进行接收并渲染



## 2.请求图片流【GET/Param】/oss/getPicture

1. 请求参数：

   | 参数名 | 参数含义 |   类型   | 是否非空 |
   | :----: | :------: | :------: | :------: |
   |   id   | 图片的id | 字符串型 |    是    |

2. 响应数据：
   图片流，可以直接用标签渲染

3. 请求示例：
   ![image-20220814112626004](接口文档v4.assets/图片流请求测试.png)



关于id的说明：

1. 视频对象的`video`字段和`cover`字段、用户对象的`profile_picture`字段、笔记对象的笔记桶中的`image_url`字段、课程的`cover`字段都是用于访问资源的id





# 十、评论模块

只有视频才有评论

## 1.查询评论【GET/Param】/comment/getComments

1. 请求参数：

   |  参数名  |         参数含义          |   类型   | 是否非空 |
   | :------: | :-----------------------: | :------: | :------: |
   | video_id |         视频的id          | 字符串型 |    是    |
   |   page   | 查询的记录页数（从1开始） |   整型   |    是    |
   |   size   |       每页的记录数        |   整型   |    是    |

2. 响应参数：
   评价类型的数组

3. 评论类型的字段介绍：

   |     参数名      |    参数含义    |   类型    | 是否非空 |
   | :-------------: | :------------: | :-------: | :------: |
   |       id        |    评论的id    | 字符串型  |    是    |
   |      body       |   评论的内容   | 字符串型  |    是    |
   | profile_picture | 用户的头像地址 | 字符串型  |    是    |
   |    reviewer     |  评论的用户名  | 字符串型  |    是    |
   |     comment     |   评论的时间   | Timestamp |    是    |

4. 请求实例：
   ![image-20220829233748771](接口文档v4.assets/查询评论请求测试.png)

   ```json
   {
       "msg": "成功",
       "code": 200,
       "data": [
           {
               "id": "27766577",
               "body": "评论测试7",
               "reviewer": "Nick",
               "profile_picture": "profile_picture/default.png",
               "comment_time": "2022-08-29T11:27:51.000+00:00"
           },
           {
               "id": "27989765",
               "body": "评论测试6",
               "reviewer": "Nick",
               "profile_picture": "profile_picture/default.png",
               "comment_time": "2022-08-29T11:27:49.000+00:00"
           },
           {
               "id": "27001326",
               "body": "评论测试5",
               "reviewer": "Nick",
               "profile_picture": "profile_picture/default.png",
               "comment_time": "2022-08-29T11:27:47.000+00:00"
           },
           {
               "id": "27767936",
               "body": "评论测试4",
               "reviewer": "Nick",
               "profile_picture": "profile_picture/default.png",
               "comment_time": "2022-08-29T11:27:45.000+00:00"
           },
           {
               "id": "27507193",
               "body": "评论测试3",
               "reviewer": "Nick",
               "profile_picture": "profile_picture/default.png",
               "comment_time": "2022-08-29T11:27:42.000+00:00"
           },
           {
               "id": "27082783",
               "body": "评论测试2",
               "reviewer": "Nick",
               "profile_picture": "profile_picture/default.png",
               "comment_time": "2022-08-29T11:27:40.000+00:00"
           },
           {
               "id": "27394945",
               "body": "评论测试1",
               "reviewer": "Nick",
               "profile_picture": "profile_picture/default.png",
               "comment_time": "2022-08-29T11:27:35.000+00:00"
           }
       ]
   }
   ```

   

## 2.添加评论【POST/JSON】/comment/addComment

1. 请求参数：

   |  参数名  |  参数含义  |   类型   | 是否非空 |
   | :------: | :--------: | :------: | :------: |
   |   body   | 评论的主题 | 字符串型 |    是    |
   | video_id |  视频的id  | 字符串型 |    是    |

2. 响应数据：

   |     参数名      |    参数含义    |   类型    | 是否非空 |
   | :-------------: | :------------: | :-------: | :------: |
   |       id        |    评论的id    | 字符串型  |    是    |
   |      body       |   评论的内容   | 字符串型  |    是    |
   | profile_picture | 用户的头像地址 | 字符串型  |    是    |
   |    reviewer     |  评论的用户名  | 字符串型  |    是    |
   |     comment     |   评论的时间   | Timestamp |    是    |

3. 请求示例：
   ![image-20220829234430957](接口文档v4.assets/添加评论请求测试.png)

   ```json
   {
       "msg": "成功",
       "code": 200,
       "data": {
           "id": "27581867",
           "body": "评论测试9",
           "reviewer": "Nick",
           "profile_picture": "profile_picture/default.png",
           "comment_time": "2022-08-29T11:27:59.000+00:00"
       }
   }
   ```

   

## 3.删除评论【DELETE/Param】/comment/deleteComments

1. 请求参数：

   | 参数名 |   参数含义   |   类型   | 是否非空 |
   | :----: | :----------: | :------: | :------: |
   |   id   |   课程的id   | 字符串型 |    是    |
   |  ids   | 课程的id集合 |   列表   |    否    |

2. 响应数据：无

3. 请求示例：
   ![image-20220829234813822](接口文档v4.assets/删除评论请求测试.png)

   ```json
   {
       "msg": "成功",
       "code": 200,
       "data": null
   }
   ```

   

# 十、搜索模块【==有更新==】

## 1.全文检索【GET/Param】/search/fullSearch

1. 请求参数：

   |  参数名  |     参数含义     |    类型    | 是否非空 |
   | :------: | :--------------: | :--------: | :------: |
   | keyword  | 用于查询的关键字 |  字符串型  |    是    |
   | category |    搜索的类别    |  字符串型  |    是    |
   |  fields  |  搜索的词条集合  | 字符串数组 |    是    |
   |   page   |  页码，从1开始   |    整型    |    是    |
   |   size   |  每页的请求数量  |    整型    |    是    |

2. 请求说明：
   1. `category`字段有两种选择，一是传入`video`，即查询视频的相关内容；二是传入`course`，即查询课程的相关内容
   2. `keyword`是本次检索所用的关键词（只有一个）
   3. `fields`是用于搜索的字段的集合
      1. 查询视频可用的字段有：`title`、`content`、`remark`、`video_abstract`、`tags`
      2. 查询课程可用的字段有：`title`、`remark`、`course_abstract`
   4. 示例：用关键字【大学物理】检索视频（`category`传入`"video"`）的标题、正文、和摘要（`fields`传入`["title","content","video_abstract"]`），返回的结果按照匹配度排序（从高到低）

3. 响应数据：
   1. 若查询的是视频，则返回视频对象的数组（和前面的查询视频完整信息的返回字段一致）
   2. 若查询的是课程，则返回课程对象的数组（和前面的查询课程完整信息的返回字段一致）



## 2.匹配检索【GET/Param】/search/matchSearch

1. 请求参数：

   |  参数名  |                     参数含义                     |    类型    | 是否非空 |
   | :------: | :----------------------------------------------: | :--------: | :------: |
   | keywords |    关键字集合（与fields数组中的元素一一对应）    | 字符串数组 |    是    |
   | category |                    搜索的类别                    |  字符串型  |    是    |
   |  fields  | 搜索的词条集合（与keywords数组中的元素一一对应） | 字符串数组 |    是    |
   |   page   |                  页码，从1开始                   |    整型    |    是    |
   |   size   |                  每页的请求数量                  |    整型    |    是    |

2. 请求说明：
   1. `category`字段有两种选择，一是传入`video`，即查询视频的相关内容；二是传入`course`，即查询课程的相关内容
   2. `keywords`是本次查询所用到的关键词列表，`fields`是用于搜索的字段的集合，二者是一一对应的
   3. 示例：查询标题包含大学物理、正文内容包含热力学、摘要包含熵增的课程，则`category`为`"course"`，`keywords`数组为：`["大学物理","热力学","熵增"]`，`fields`数组为：`["title","content","course_abstract"]`

3. 响应数据：
   1. 若查询的是视频，则返回视频对象的数组（和前面的查询视频完整信息的返回字段一致）
   2. 若查询的是课程，则返回课程对象的数组（和前面的查询课程完整信息的返回字段一致）



## 3.深度搜索【GET/Param】/search/deepSearch

1. 请求参数：

   |  参数名  |     参数含义     |   类型   | 是否非空 |
   | :------: | :--------------: | :------: | :------: |
   | keyword  | 用于查询的关键字 | 字符串型 |    是    |
   | category |    搜索的类别    | 字符串型 |    是    |
   |   page   |  页码，从1开始   |   整型   |    是    |
   |   size   |  每页的请求数量  |   整型   |    是    |

2. 请求说明：

   1. `category`字段有两种选择，一是传入`video`，即对视频的内容标签（字段名为：`labels`）进行搜索；二是传入`course`，即对课程的章节标签（字段名为：`chapters`）进行搜索

3. 响应数据：

   1. 若查询的是视频，则返回内容标签对象的数组，内容标签对象有如下字段：

      |   参数名    |      参数含义      |   类型   | 是否非空 |
      | :---------: | :----------------: | :------: | :------: |
      |     id      |      标签的id      | 字符串型 |    是    |
      |    start    | 对应进度的起始位置 |  浮点型  |    是    |
      |     end     | 对应进度的结束位置 |  浮点型  |    是    |
      |    body     |      标签内容      | 字符串型 |    是    |
      |  video_id   |       视频id       | 字符串型 |    是    |
      | video_title |      视频标题      | 字符串型 |    是    |

   2. 若查询的是课程，则返回课程章节对象的数组，章节对象有两类，一类是标题章节，还有一类是视频章节

      1. 标题章节对象有如下字段：

      |    参数名    |    参数含义    |                    类型                    | 是否非空 |
      | :----------: | :------------: | :----------------------------------------: | :------: |
      |      id      |    章节的id    |                  字符串型                  |    是    |
      |   level_id   | 所属章节的层级 | 字符串型（形式如：`1`、``1.1`、`2.1.2`等） |    是    |
      |     body     | 所属章节的标题 |                  字符串型                  |    是    |
      |  course_id   |     课程id     |                  字符串型                  |    是    |
      | course_title |    课程标题    |                  字符串型                  |    是    |

      2. 视频章节对象有如下字段

      |    参数名    |    参数含义    |                    类型                    | 是否非空 |
      | :----------: | :------------: | :----------------------------------------: | :------: |
      |      id      |    章节的id    |                  字符串型                  |    是    |
      |   level_id   | 所属章节的层级 | 字符串型（形式如：`1`、``1.1`、`2.1.2`等） |    是    |
      |     body     | 所属章节的标题 |                  字符串型                  |    是    |
      |   video_id   |  对应视频的id  |                  字符串型                  |    是    |
      | video_title  | 对应视频的标题 |                  字符串型                  |    是    |
      |  course_id   |     课程id     |                  字符串型                  |    是    |
      | course_title |    课程标题    |                  字符串型                  |    是    |















































